<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Intranet Space - nishang &lt;ReadTeam/Powershell/Penetration-testing> - 倾旋的博客</title><meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/main.css><link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://payloads.online/css/dark.css><script src=https://payloads.online/js/feather.min.js></script><script src=https://payloads.online/js/main.js></script></head><body><div class="container-wide wrapper"><div class=header><div class=avatar><a href=https://payloads.online/><img src=/avatar.jpeg alt=倾旋的博客></a></div><h1 class=site-title><a href=https://payloads.online/>倾旋的博客</a></h1><div class=site-description><p>现阶段在进行有效性验证/攻击模拟相关的安全研究工作，我的博客会记录一些我的学习过程和部分安全技术研究成果。</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/rvn0xsy/ title=Github><i data-feather=github></i></a></li><li><a href=/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>首页</a></li><li><a href=/posts/>文章列表</a></li><li><a href=/tags>标签</a></li><li><a href=/projects>开源项目</a></li><li><a href=/about>关于我</a></li><li><a href=/links/>友情链接</a></li><li><a href=/message>留言</a></li><li><a href=/sponsor>赞助</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>19</span>
<span class=rest>Dec 2018</span></div></div><div class=matter><h1 class=title>Intranet Space - nishang &lt;ReadTeam/Powershell/Penetration-testing></h1></div></div><aside class="show-on-mobile toc" id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#0x00-powershell-executionpolicy执行策略>0x00 Powershell ExecutionPolicy（执行策略）</a><ol><li><a href=#设置执行策略set-executionpolicy>设置执行策略(Set-ExecutionPolicy)</a></li><li><a href=#执行策略影响范围scope>执行策略影响范围（Scope）</a></li><li><a href=#删除执行策略>删除执行策略</a></li><li><a href=#设置会话执行策略>设置会话执行策略</a></li></ol></li><li><a href=#0x01-nishang>0x01 Nishang</a></li><li><a href=#0x02-usage>0x02 Usage</a></li><li><a href=#0x03-模块分类>0x03 模块分类</a><ol><li></li></ol></li><li><a href=#0x04-卸载系统补丁>0x04 卸载系统补丁</a></li><li><a href=#0x05-others>0x05 others</a></li><li><a href=#ref>Ref</a></li></ol></nav></aside><h2 id=0x00-powershell-executionpolicy执行策略>0x00 Powershell ExecutionPolicy（执行策略）</h2><h3 id=设置执行策略set-executionpolicy>设置执行策略(Set-ExecutionPolicy)</h3><p>Powershell默认的权限策略是：“Restricted”</p><p>查看当前执行策略：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>PS C:&gt; Get-ExecutionPolicy
</span></span><span style=display:flex><span>Restricted
</span></span></code></pre></td></tr></table></div></div><p>查看所有执行策略：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>PS E:&gt;  [System.Enum]::GetNames([Microsoft.PowerShell.ExecutionPolicy])
</span></span><span style=display:flex><span>Unrestricted # 权限最高，可以不受限制执行任何脚本。
</span></span><span style=display:flex><span>RemoteSigned # 本地脚本无限制，但是对来自网络的脚本必须经过签名
</span></span><span style=display:flex><span>AllSigned    # 所有脚本都必须经过签名才能在运行
</span></span><span style=display:flex><span>Restricted   # Powershell默认的策略，不允许任何脚本执行
</span></span><span style=display:flex><span>Default      # 为Powershell默认的策略
</span></span><span style=display:flex><span>Bypass       # 无任何限制策略，不警告、不提示
</span></span><span style=display:flex><span>Undefined    # 当前范围中没有设置执行策略
</span></span></code></pre></td></tr></table></div></div><p>设置执行策略：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Set-ExecutionPolicy -ExecutionPolicy &lt;PolicyName&gt;
</span></span></code></pre></td></tr></table></div></div><p>设置执行策略，并设置影响对象：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Set-ExecutionPolicy -ExecutionPolicy &lt;PolicyName&gt; -Scope &lt;scope&gt;
</span></span></code></pre></td></tr></table></div></div><h3 id=执行策略影响范围scope>执行策略影响范围（Scope）</h3><p>影响范围：Scope ，设置策略时选择影响对象。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>PS C:&gt;Get-ExecutionPolicy -List
</span></span><span style=display:flex><span>        Scope ExecutionPolicy
</span></span><span style=display:flex><span>        ----- ---------------
</span></span><span style=display:flex><span>MachinePolicy       Undefined
</span></span><span style=display:flex><span>   UserPolicy       Undefined
</span></span><span style=display:flex><span>      Process       Undefined
</span></span><span style=display:flex><span>  CurrentUser    RemoteSigned
</span></span><span style=display:flex><span> LocalMachine       AllSigned
</span></span></code></pre></td></tr></table></div></div><ul><li>CurrentUser：执行策略仅影响当前用户。它存储在HKEY_CURRENT_USER注册表子项中。</li><li>Process ： 执行策略仅影响当前会话（当前的PowerShell进程）。</li><li>LOCALMACHINE ：执行策略会影响当前计算机上的所有用户。它存储在HKEY_LOCAL_MACHINE注册表子项中。</li></ul><p><strong>修改执行策略需要管理员权限</strong></p><h3 id=删除执行策略>删除执行策略</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Set-ExecutionPolicy Undefined
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Set-ExecutionPolicy Undefined -Scope LocalMachine
</span></span></code></pre></td></tr></table></div></div><h3 id=设置会话执行策略>设置会话执行策略</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>powershell -ExecutionPolicy Bypass ...
</span></span></code></pre></td></tr></table></div></div><h2 id=0x01-nishang>0x01 Nishang</h2><p>Nishang is a framework and collection of scripts and payloads which enables usage of PowerShell for offensive security, penetration testing and red teaming. Nishang is useful during all phases of penetration testing.</p><h2 id=0x02-usage>0x02 Usage</h2><p>Import all the scripts in the current PowerShell session (PowerShell v3 onwards).</p><p>如何使用：导入所有的脚本到当前的Powershell会话中，但是Powershell的版本必须是version 3。</p><p><strong>导入命令：</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>PS C:\nishang&gt; Import-Module .\nishang.psm1
</span></span></code></pre></td></tr></table></div></div><p>单独导入：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>PS C:\nishang&gt; . C:\nishang\Gather\Get-Information.ps1
</span></span><span style=display:flex><span>PS C:\nishang&gt; Get-Information
</span></span></code></pre></td></tr></table></div></div><p>获取函数的帮助信息可以这样输入：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>To get help about any script or function, use:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PS C:\nishang&gt; Get-Help [scriptname] -full
</span></span></code></pre></td></tr></table></div></div><h2 id=0x03-模块分类>0x03 模块分类</h2><h4 id=scripts>Scripts</h4><p>Nishang currently contains the following scripts and payloads.</p><h4 id=activedirectory>ActiveDirectory</h4><p><a href=https://github.com/samratashok/nishang/blob/master/ActiveDirectory/Set-DCShadowPermissions.ps1>Set-DCShadowPermissions</a></p><p>Modify AD objects to provide minimal permissions required for DCShadow.</p><h4 id=antak---the-webshell>Antak - the Webshell</h4><p><a href=https://github.com/samratashok/nishang/tree/master/Antak-WebShell>Antak</a></p><p>Execute PowerShell scripts in memory, run commands, and download and upload files using this webshell.</p><h4 id=backdoors>Backdoors</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/HTTP-Backdoor.ps1>HTTP-Backdoor</a></p><p>A backdoor which can receive instructions from third party websites and execute PowerShell scripts in memory.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1>DNS_TXT_Pwnage</a></p><p>A backdoor which can receive commands and PowerShell scripts from DNS TXT queries, execute them on a target, and be remotely controlled using the queries.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/Execute-OnTime.ps1>Execute-OnTime</a></p><p>A backdoor which can execute PowerShell scripts at a given time on a target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/Gupt-Backdoor.ps1>Gupt-Backdoor</a></p><p>A backdoor which can receive commands and scripts from a WLAN SSID without connecting to it.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/Add-ScrnSaveBackdoor.ps1>Add-ScrnSaveBackdoor</a></p><p>A backdoor which can use Windows screen saver for remote command and script execution.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/Invoke-ADSBackdoor.ps1>Invoke-ADSBackdoor</a></p><p>A backdoor which can use alternate data streams and Windows Registry to achieve persistence.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/Add-RegBackdoor.ps1>Add-RegBackdoor</a></p><p>A backdoor which uses well known Debugger trick to execute payload with Sticky keys and Utilman (Windows key + U).</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/Set-RemoteWMI.ps1>Set-RemoteWMI</a></p><p>Modify permissions of DCOM and WMI namespaces to allow access to a non-admin user.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Backdoors/Set-RemotePSRemoting.ps1>Set-RemotePSRemoting</a></p><p>Modify permissions of PowerShell remoting to allow access to a non-admin user.</p><h4 id=bypass>Bypass</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Bypass/Invoke-AmsiBypass.ps1>Invoke-AmsiBypass</a></p><p>Implementation of publicly known methods to bypass/avoid AMSI.</p><h4 id=client>Client</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1>Out-CHM</a></p><p>Create infected CHM files which can execute PowerShell commands and scripts.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-Word.ps1>Out-Word</a></p><p>Create Word files and infect existing ones to run PowerShell commands and scripts.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-Excel.ps1>Out-Excel</a></p><p>Create Excel files and infect existing ones to run PowerShell commands and scripts.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-HTA.ps1>Out-HTA</a></p><p>Create a HTA file which can be deployed on a web server and used in phishing campaigns.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-Java.ps1>Out-Java</a></p><p>Create signed JAR files which can be used with applets for script and command execution.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-Shortcut.ps1>Out-Shortcut</a></p><p>Create shortcut files capable of executing PowerShell commands and scripts.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-WebQuery.ps1>Out-WebQuery</a></p><p>Create IQY files for phishing credentials and SMB hashes.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-JS.ps1>Out-JS</a></p><p>Create JS files capable of executing PowerShell commands and scripts.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-SCT.ps1>Out-SCT</a></p><p>Create SCT files capable of executing PowerShell commands and scripts.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Client/Out-SCF.ps1>Out-SCF</a></p><p>Create a SCF file which can be used for capturing NTLM hash challenges.</p><h4 id=escalation>Escalation</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Escalation/Enable-DuplicateToken.ps1>Enable-DuplicateToken</a></p><p>When SYSTEM privileges are required.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Escalation/Remove-Update.ps1>Remove-Update</a></p><p>Introduce vulnerabilities by removing patches.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Escalation/Invoke-PsUACme.ps1>Invoke-PsUACme</a></p><p>Bypass UAC.</p><h4 id=execution>Execution</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Execution/Download-Execute-PS.ps1>Download-Execute-PS</a></p><p>Download and execute a PowerShell script in memory.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Execution/Download_Execute.ps1>Download_Execute</a></p><p>Download an executable in text format, convert it to an executable, and execute.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Execution/Execute-Command-MSSQL.ps1>Execute-Command-MSSQL</a></p><p>Run PowerShell commands, native commands, or SQL commands on a MSSQL Server with sufficient privileges.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Execution/Execute-DNSTXT-Code.ps1>Execute-DNSTXT-Code</a></p><p>Execute shellcode in memory using DNS TXT queries.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Execution/Out-RundllCommand.ps1>Out-RundllCommand</a></p><p>Execute PowerShell commands and scripts or a reverse PowerShell session using rundll32.exe.</p><h4 id=gather>Gather</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Check-VM.ps1>Check-VM</a></p><p>Check for a virtual machine.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Copy-VSS.ps1>Copy-VSS</a></p><p>Copy the SAM file using Volume Shadow Copy Service.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Credentials.ps1>Invoke-CredentialsPhish</a></p><p>Trick a user into giving credentials in plain text.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/FireBuster.ps1>FireBuster</a>
<a href=https://github.com/samratashok/nishang/blob/master/Gather/FireListener.ps1>FireListener</a></p><p>A pair of scripts for egress testing</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Get-Information.ps1>Get-Information</a></p><p>Get juicy information from a target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Get-LSASecret.ps1>Get-LSASecret</a></p><p>Get LSA Secret from a target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Get-PassHashes.ps1>Get-PassHashes</a></p><p>Get password hashes from a target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Get-WLAN-Keys.ps1>Get-WLAN-Keys</a></p><p>Get WLAN keys in plain text from a target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Keylogger.ps1>Keylogger</a></p><p>Log keystrokes from a target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Invoke-MimikatzWDigestDowngrade.ps1>Invoke-MimikatzWdigestDowngrade</a></p><p>Dump user passwords in plain on Windows 8.1 and Server 2012</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Get-PassHints.ps1>Get-PassHints</a></p><p>Get password hints of Windows users from a target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Show-TargetScreen.ps1>Show-TargetScreen</a></p><p>Connect back and Stream target screen using MJPEG.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Invoke-Mimikatz.ps1>Invoke-Mimikatz</a></p><p>Load mimikatz in memory. Updated and with some customisation.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Invoke-Mimikittenz.ps1>Invoke-Mimikittenz</a></p><p>Extract juicy information from target process (like browsers) memory using regex.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Invoke-SSIDExfil.ps1>Invoke-SSIDExfil</a></p><p>Exfiltrate information like user credentials, using WLAN SSID.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Gather/Invoke-SessionGopher.ps1>Invoke-SessionGopher</a></p><p>Identify admin jump-boxes and/or computers used to access Unix machines.</p><h4 id=mitm>MITM</h4><p><a href=https://github.com/samratashok/nishang/blob/master/MITM/Invoke-Interceptor.ps1>Invoke-Interceptor</a></p><p>A local HTTPS proxy for MITM attacks.</p><h4 id=pivot>Pivot</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Pivot/Create-MultipleSessions.ps1>Create-MultipleSessions</a></p><p>Check credentials on multiple computers and create PSSessions.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Pivot/Run-EXEonRemote.ps1>Run-EXEonRemote</a>
Copy and execute an executable on multiple machines.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Pivot/Invoke-NetworkRelay.ps1>Invoke-NetworkRelay</a>
Create network relays between computers.</p><h4 id=prasadhak>Prasadhak</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Prasadhak/Prasadhak.ps1>Prasadhak</a></p><p>Check running hashes of running process against the VirusTotal database.</p><h4 id=scan>Scan</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Scan/Brute-Force.ps1>Brute-Force</a></p><p>Brute force FTP, Active Directory, MSSQL, and Sharepoint.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Scan/Port-Scan.ps1>Port-Scan</a></p><p>A handy port scanner.</p><h4 id=powerpreter>Powerpreter</h4><p><a href=https://github.com/samratashok/nishang/tree/master/powerpreter>Powerpreter</a></p><p>All the functionality of nishang in a single script module.</p><h4 id=shells>Shells</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PsGcat.ps1>Invoke-PsGcat</a></p><p>Send commands and scripts to specifed Gmail account to be executed by Invoke-PsGcatAgent</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PsGcatAgent.ps1>Invoke-PsGcatAgent</a></p><p>Execute commands and scripts sent by Invoke-PsGcat.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1>Invoke-PowerShellTcp</a></p><p>An interactive PowerShell reverse connect or bind shell</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1>Invoke-PowerShellTcpOneLine</a></p><p>Stripped down version of Invoke-PowerShellTcp. Also contains, a skeleton version which could fit in two tweets.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLineBind.ps1>Invoke-PowerShellTcpOneLineBind</a></p><p>Bind version of Invoke-PowerShellTcpOneLine.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellUdp.ps1>Invoke-PowerShellUdp</a></p><p>An interactive PowerShell reverse connect or bind shell over UDP</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellUdpOneLine.ps1>Invoke-PowerShellUdpOneLine</a></p><p>Stripped down version of Invoke-PowerShellUdp.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PoshRatHttps.ps1>Invoke-PoshRatHttps</a></p><p>Reverse interactive PowerShell over HTTPS.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PoshRatHttp.ps1>Invoke-PoshRatHttp</a></p><p>Reverse interactive PowerShell over HTTP.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Remove-PoshRat.ps1>Remove-PoshRat</a></p><p>Clean the system after using Invoke-PoshRatHttps</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellWmi.ps1>Invoke-PowerShellWmi</a></p><p>Interactive PowerShell using WMI.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellIcmp.ps1>Invoke-PowerShellIcmp</a></p><p>An interactive PowerShell reverse shell over ICMP.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-JSRatRundll.ps1>Invoke-JSRatRundll</a></p><p>An interactive PowerShell reverse shell over HTTP using rundll32.exe.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-JSRatRegsvr.ps1>Invoke-JSRatRegsvr</a></p><p>An interactive PowerShell reverse shell over HTTP using regsvr32.exe.</p><h4 id=utility>Utility</h4><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Add-Exfiltration.ps1>Add-Exfiltration</a></p><p>Add data exfiltration capability to Gmail, Pastebin, a web server, and DNS to any script.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Add-Persistence.ps1>Add-Persistence</a></p><p>Add reboot persistence capability to a script.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Remove-Persistence.ps1>Remove-Persistence</a></p><p>Remote persistence added by the Add-Persistence script.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Do-Exfiltration.ps1>Do-Exfiltration</a></p><p>Pipe (|) this to any script to exfiltrate the output.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Download.ps1>Download</a></p><p>Transfer a file to the target.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Parse_Keys.ps1>Parse_Keys</a></p><p>Parse keys logged by the keylogger.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Invoke-Decode.ps1>Invoke-Encode</a></p><p>Encode and compress a script or string.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Invoke-Decode.ps1>Invoke-Decode</a></p><p>Decode and decompress a script or string from Invoke-Encode.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Start-CaptureServer.ps1>Start-CaptureServer</a></p><p>Run a web server which logs Basic authentication and SMB hashes.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/ConvertTo-ROT13.ps1>ConvertTo-ROT13</a></p><p>Encode a string to ROT13 or decode a ROT13 string.</p><p><a href=https://github.com/samratashok/nishang/blob/master/Utility/Out-DnsTxt.ps1>Out-DnsTxt</a></p><p>Generate DNS TXT records which could be used with other scripts.</p><p>[Base64ToString]</p><p>[StringToBase64]</p><p>[ExetoText]</p><p>[TexttoExe]</p><h2 id=0x04-卸载系统补丁>0x04 卸载系统补丁</h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>PS C:\Users\Rvn0xsy\Downloads\nishang<span style=color:#f92672>-</span>master<span style=color:#f92672>&gt;</span> systeminfo
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>主机名</span>:           DESKTOP<span style=color:#f92672>-</span><span style=color:#ae81ff>7</span>KT7GL1
</span></span><span style=display:flex><span><span style=color:#a6e22e>OS</span> <span style=color:#960050;background-color:#1e0010>名称</span>:          Microsoft Windows <span style=color:#ae81ff>10</span> <span style=color:#960050;background-color:#1e0010>企业版</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>OS</span> <span style=color:#960050;background-color:#1e0010>版本</span>:          <span style=color:#ae81ff>10.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>15063</span> <span style=color:#960050;background-color:#1e0010>暂缺</span> Build <span style=color:#ae81ff>15063</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>OS</span> <span style=color:#960050;background-color:#1e0010>制造商</span>:        Microsoft Corporation
</span></span><span style=display:flex><span><span style=color:#a6e22e>OS</span> <span style=color:#960050;background-color:#1e0010>配置</span>:          <span style=color:#960050;background-color:#1e0010>独立工作站</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>OS</span> <span style=color:#960050;background-color:#1e0010>构件类型</span>:      Multiprocessor Free
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>注册的所有人</span>:     Windows <span style=color:#960050;background-color:#1e0010>用户</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>注册的组织</span>:
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>产品</span> ID:          <span style=color:#ae81ff>00329</span><span style=color:#f92672>-</span><span style=color:#ae81ff>00000</span><span style=color:#f92672>-</span><span style=color:#ae81ff>00003</span><span style=color:#f92672>-</span>AA343
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>初始安装日期</span>:     <span style=color:#ae81ff>2018</span><span style=color:#f92672>/</span><span style=color:#ae81ff>10</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>03</span>:<span style=color:#ae81ff>48</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>系统启动时间</span>:     <span style=color:#ae81ff>2018</span><span style=color:#f92672>/</span><span style=color:#ae81ff>10</span><span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>03</span>:<span style=color:#ae81ff>27</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>系统制造商</span>:       VMware, Inc<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>系统型号</span>:         VMware7,<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>系统类型</span>:         x64<span style=color:#f92672>-</span>based PC
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>处理器</span>:           <span style=color:#960050;background-color:#1e0010>安装了</span> <span style=color:#ae81ff>1</span> <span style=color:#960050;background-color:#1e0010>个处理器。</span>
</span></span><span style=display:flex><span>                  [<span style=color:#ae81ff>01</span>]: Intel64 Family <span style=color:#ae81ff>6</span> Model <span style=color:#ae81ff>158</span> Stepping <span style=color:#ae81ff>10</span> GenuineIntel <span style=color:#f92672>~</span><span style=color:#ae81ff>259</span>
</span></span><span style=display:flex><span>BIOS <span style=color:#960050;background-color:#1e0010>版本</span>:        VMware, Inc<span style=color:#f92672>.</span> VMW71<span style=color:#f92672>.</span><span style=color:#ae81ff>00</span>V<span style=color:#f92672>.</span><span style=color:#ae81ff>6997262.</span>B64<span style=color:#f92672>.</span><span style=color:#ae81ff>1710270607</span>, <span style=color:#ae81ff>2017</span><span style=color:#f92672>/</span><span style=color:#ae81ff>10</span><span style=color:#f92672>/</span><span style=color:#ae81ff>27</span>
</span></span><span style=display:flex><span>Windows <span style=color:#960050;background-color:#1e0010>目录</span>:     C:\Windows
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>系统目录</span>:         C:\Windows\system32
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>启动设备</span>:         \Device\HarddiskVolume1
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>系统区域设置</span>:     zh<span style=color:#f92672>-</span>cn;<span style=color:#960050;background-color:#1e0010>中文</span>(<span style=color:#960050;background-color:#1e0010>中国</span>)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>输入法区域设置</span>:   zh<span style=color:#f92672>-</span>cn;<span style=color:#960050;background-color:#1e0010>中文</span>(<span style=color:#960050;background-color:#1e0010>中国</span>)
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>时区</span>:             (UTC<span style=color:#f92672>+</span><span style=color:#ae81ff>08</span>:<span style=color:#ae81ff>00</span>) <span style=color:#960050;background-color:#1e0010>北京，重庆，香港特别行政区，乌鲁木齐</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>物理内存总量</span>:     <span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>067</span> MB
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>可用的物理内存</span>:   <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>521</span> MB
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>虚拟内存</span>: <span style=color:#960050;background-color:#1e0010>最大值</span>: <span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>475</span> MB
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>虚拟内存</span>: <span style=color:#960050;background-color:#1e0010>可用</span>:   <span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>035</span> MB
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>虚拟内存</span>: <span style=color:#960050;background-color:#1e0010>使用中</span>: <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>440</span> MB
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>页面文件位置</span>:     C:\pagefile<span style=color:#f92672>.</span>sys
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>域</span>:               WORKGROUP
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>登录服务器</span>:       \\WIN<span style=color:#f92672>-</span>HPD6618QKUJ
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>修补程序</span>:         <span style=color:#960050;background-color:#1e0010>安装了</span> <span style=color:#ae81ff>3</span> <span style=color:#960050;background-color:#1e0010>个修补程序。</span>
</span></span><span style=display:flex><span>                  [<span style=color:#ae81ff>01</span>]: KB4022405
</span></span><span style=display:flex><span>                  [<span style=color:#ae81ff>02</span>]: KB4025376
</span></span><span style=display:flex><span>                  [<span style=color:#ae81ff>03</span>]: KB4025342
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>网卡</span>:             <span style=color:#960050;background-color:#1e0010>安装了</span> <span style=color:#ae81ff>2</span> <span style=color:#960050;background-color:#1e0010>个</span> NIC<span style=color:#960050;background-color:#1e0010>。</span>
</span></span><span style=display:flex><span>                  [<span style=color:#ae81ff>01</span>]: Intel(R) <span style=color:#ae81ff>82574</span>L Gigabit Network Connection
</span></span><span style=display:flex><span>                      <span style=color:#960050;background-color:#1e0010>连接名</span>:      Ethernet0
</span></span><span style=display:flex><span>                      <span style=color:#960050;background-color:#1e0010>启用</span> DHCP:   <span style=color:#960050;background-color:#1e0010>是</span>
</span></span><span style=display:flex><span>                      DHCP <span style=color:#960050;background-color:#1e0010>服务器</span>: <span style=color:#ae81ff>192.168</span><span style=color:#f92672>.</span><span style=color:#ae81ff>117.254</span>
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>IP</span> <span style=color:#960050;background-color:#1e0010>地址</span>
</span></span><span style=display:flex><span>                        [<span style=color:#ae81ff>01</span>]: <span style=color:#ae81ff>192.168</span><span style=color:#f92672>.</span><span style=color:#ae81ff>117.179</span>
</span></span><span style=display:flex><span>                        [<span style=color:#ae81ff>02</span>]: fe80::<span style=color:#ae81ff>34</span>d3:<span style=color:#ae81ff>6</span>c58:d461:cc5e
</span></span><span style=display:flex><span>                  [<span style=color:#ae81ff>02</span>]: Bluetooth Device (Personal <span style=color:#a6e22e>Area</span> Network)
</span></span><span style=display:flex><span>                      <span style=color:#960050;background-color:#1e0010>连接名</span>:      <span style=color:#960050;background-color:#1e0010>蓝牙网络连接</span>
</span></span><span style=display:flex><span>                      <span style=color:#960050;background-color:#1e0010>状态</span>:        <span style=color:#960050;background-color:#1e0010>媒体连接已中断</span>
</span></span><span style=display:flex><span>Hyper<span style=color:#f92672>-</span>V <span style=color:#960050;background-color:#1e0010>要求</span>:     <span style=color:#960050;background-color:#1e0010>已检测到虚拟机监控程序。将不显示</span> Hyper<span style=color:#f92672>-</span>V <span style=color:#960050;background-color:#1e0010>所需的功能。</span>
</span></span><span style=display:flex><span>PS C:\Users\Rvn0xsy\Downloads\nishang<span style=color:#f92672>-</span>master<span style=color:#f92672>&gt;</span> Remove<span style=color:#f92672>-</span>Update All
</span></span><span style=display:flex><span>Removing update <span style=color:#ae81ff>4022405</span> from the target<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Waiting <span style=color:#66d9ef>for</span> update removal to finish <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>Removing update <span style=color:#ae81ff>4025376</span> from the target<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Waiting <span style=color:#66d9ef>for</span> update removal to finish <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>Removing update <span style=color:#ae81ff>4025342</span> from the target<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Waiting <span style=color:#66d9ef>for</span> update removal to finish <span style=color:#f92672>...</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-12-19/0x02.png alt></p><h2 id=0x05-others>0x05 others</h2><p>可以参考：https://github.com/samratashok/nishang/blob/master/README.md</p><h2 id=ref>Ref</h2><ul><li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-6#execution-policy-scope">About Execution Policies</a></li></ul></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#0x00-powershell-executionpolicy执行策略>0x00 Powershell ExecutionPolicy（执行策略）</a><ol><li><a href=#设置执行策略set-executionpolicy>设置执行策略(Set-ExecutionPolicy)</a></li><li><a href=#执行策略影响范围scope>执行策略影响范围（Scope）</a></li><li><a href=#删除执行策略>删除执行策略</a></li><li><a href=#设置会话执行策略>设置会话执行策略</a></li></ol></li><li><a href=#0x01-nishang>0x01 Nishang</a></li><li><a href=#0x02-usage>0x02 Usage</a></li><li><a href=#0x03-模块分类>0x03 模块分类</a><ol><li></li></ol></li><li><a href=#0x04-卸载系统补丁>0x04 卸载系统补丁</a></li><li><a href=#0x05-others>0x05 others</a></li><li><a href=#ref>Ref</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags></div><div class=back><a href=https://payloads.online/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post></div></div><div class="footer wrapper"><nav class=nav><div>2024 倾旋 All rights reserved</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>