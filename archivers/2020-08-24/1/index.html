<!DOCTYPE html>
<html lang=""><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>这是一个充满挑战的好时代</title>
    <meta name="description" content="倾旋的博客">
    <meta name="author" content='倾旋'>

    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous">

    
    <link rel="stylesheet" href="/sass/researcher.min.css">

    
        <link rel="icon" type="image/ico" href="https://payloads.online/favicon.ico">
    

    
        
    
</head>

    <body><div class="container mt-5">
    <nav class="navbar navbar-expand-sm flex-column flex-sm-row text-nowrap p-0">
        <a class="navbar-brand mx-0 mr-sm-auto" style="color: #dc3545;" href="https://payloads.online" title="倾旋的博客">
          
          倾旋的博客
        </a>
        <div class="navbar-nav flex-row flex-wrap justify-content-center">
            
                
                
                    <a class="nav-item nav-link" href="/about" title="About">
                        About
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/projects/" title="Projects">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-terminal-fill" viewBox="0 0 16 16"><path d="M0 3a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3zm9.5 5.5h-3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zm-6.354-.354a.5.5 0 1 0 .708.708l2-2a.5.5 0 0 0 0-.708l-2-2a.5.5 0 1 0-.708.708L4.793 6.5 3.146 8.146z"/></svg> Projects
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/links/" title="Links">
                        Links
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/post/" title="Posts">
                        Posts
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/index.xml" title="Rss">
                        Rss
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/tools/" title="Tools">
                        Tools
                    </a>
                    
                
            
        </div>
    </nav>
</div>
<hr>
<div id="content">
<div class="container">
    <p>我经常会写一些不着边际的东西，从我博客文章就可以看出现在的风格，前言不搭后语、文章主体和内容松散不一，说来惭愧，文化程度不高，也想抽空读读书花点功夫补缺一下。</p>
<p>近期发生了很多的事儿，很多时候在晚上会产生一些感触，但是都没有把它们给记录下来，现在点来一支烟，慢慢回忆……</p>
<h2 id="第一个思考我感受到了自动化时代的冲击">第一个思考：我感受到了自动化时代的冲击</h2>
<p>听闻关于演练的消息，也就一天时间，不知消息真假的情况下开始推论参赛厂商的自动化覆盖程度，发现整个行业的意识形态已经建立，未来（或已经存在的）漏洞战争的趋势已经开始逼近。</p>
<p>关于自动化的设计，我们早期已经着手将基本的信息获取、清洗、统计、归类、存储整个过程完成，但就此一战，能很明显的发现自动化是有阶段的，我们还处于第一阶段。起初，我们为了加速红队的“行动”，做了诸多的考虑。我认为，为了完成整个行动的自动化是不太现实的，难点在于经验如何转化为机器的逻辑。步子不能迈的太大，我先分解一下我理想的自动化阶段。</p>
<h3 id="第一阶段单从基本信息收集的具备">第一阶段：单从基本信息收集的具备</h3>
<p>涉及多个维度，域名、子域名、IP、系统、端口、服务、Http服务相关组件等，互联网上的大部分工具、平台可能大部分已经满足这些最小颗粒度，但有些工具、平台就是偏离真正的需求。</p>
<h3 id="第二阶段基本信息收集的数据支撑">第二阶段：基本信息收集的数据支撑</h3>
<p>同样涉及多个角度，主动扫描、网络空间搜索引擎数据接口、组件指纹精准度、识别技术方案等。未来主动扫描可能用的会越来越少，依赖接口的会更多一些，接口只要更加实时的更新数据即可，然后确保构建好指纹的精准度，做到不漏掉一处资产的特征就很成功了。最早接触的一个网络空间搜索引擎是Shodan，我经过查阅Wiki百科发现它最早在2013年做起来，距今已经7年，在常规的渗透中，也会偶尔使用它来寻找一些有趣的资产，在IPV4的时代下，它已经算是一个“活地图”了，这里可以思考一个有趣的问题，当世界上更普遍使用IPv6以后，是否还会有类似的“活地图”呢？</p>
<h3 id="第三阶段启发式漏洞的定位发现">第三阶段：启发式漏洞的定位发现</h3>
<p>最初这个概念是我在参与团队内部平台建设讨论时提出的，其实也不是什么新词，为了应对这个建立了大大小小的SOC（Security operations center，安全运营中心）时代，我们需要把历史的扫描器丢弃，把攻击的特征降噪、剔除更多漏洞利用的唯一性，第一步就要将漏洞的发现理解为单纯的“发现”，而非“发现”与“利用”在一起去理解。例如，某个系统存在RCE（Remote Code Execution Vulnerability，远程代码执行漏洞），利用条件是要向网站某个接口POST一段数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; POST /handler/ HTTP/1.1
&gt; Host: 192.168.0.1
&gt; User-Agent: Mozilla/5.0 <span style="color:#f92672">(</span>Windows NT 10.0; Win64; x64<span style="color:#f92672">)</span> AppleWebKit/537.36 <span style="color:#f92672">(</span>KHTML, like Gecko<span style="color:#f92672">)</span> Chrome/84.0.4147.135 Safari/537.36
&gt; Accept: */*
&gt; Content-Length: <span style="color:#ae81ff">8</span>
&gt; Content-Type: application/x-www-form-urlencoded

data<span style="color:#f92672">={</span><span style="color:#e6db74">&#39;username&#39;</span>:<span style="color:#e6db74">&#39;code&#39;</span><span style="color:#f92672">}</span>

&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; Content-Type: text/html
&lt; Server: Microsoft-IIS/7.5
&lt; X-Powered-By: ASP.NET
&lt; Date: Sun, <span style="color:#ae81ff">23</span> Aug <span style="color:#ae81ff">2020</span> 14:13:45 GMT
&lt; Content-Length: <span style="color:#ae81ff">1163</span>

....
</code></pre></div><p>假设<code>code</code>是代码输入点，如果要进行漏洞的发现或利用，大部分人可能比较倾向于提交执行的代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; POST /handler/ HTTP/1.1
&gt; Host: 192.168.0.1
&gt; User-Agent: Mozilla/5.0 <span style="color:#f92672">(</span>Windows NT 10.0; Win64; x64<span style="color:#f92672">)</span> AppleWebKit/537.36 <span style="color:#f92672">(</span>KHTML, like Gecko<span style="color:#f92672">)</span> Chrome/84.0.4147.135 Safari/537.36
&gt; Accept: */*
&gt; Content-Length: <span style="color:#ae81ff">8</span>
&gt; Content-Type: application/x-www-form-urlencoded

data<span style="color:#f92672">={</span><span style="color:#e6db74">&#39;username&#39;</span>:<span style="color:#e6db74">&#39;md5(1)&#39;</span><span style="color:#f92672">}</span>

&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; Content-Type: text/html
&lt; Server: Microsoft-IIS/7.5
&lt; X-Powered-By: ASP.NET
&lt; Date: Sun, <span style="color:#ae81ff">23</span> Aug <span style="color:#ae81ff">2020</span> 14:13:45 GMT
&lt; Content-Length: <span style="color:#ae81ff">1163</span>

....c4ca4238a0b923820dcc509a6f75849b....
</code></pre></div><p>因为让服务器端执行了md5函数，然后匹配响应内容中是否存在c4ca4238a0b923820dcc509a6f75849b由此来判断是否存在漏洞。</p>
<p>但在现在的大环境下，我不太赞成这样做，如果第一二阶段的工作做得相对比较扎实，完全可以直接判断<code>/handler/</code> 是否存在即可标记“可能存在漏洞”。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; GET /handler/ HTTP/1.1
&gt; Host: 192.168.0.1
&gt; User-Agent: Mozilla/5.0 <span style="color:#f92672">(</span>Windows NT 10.0; Win64; x64<span style="color:#f92672">)</span> AppleWebKit/537.36 <span style="color:#f92672">(</span>KHTML, like Gecko<span style="color:#f92672">)</span> Chrome/84.0.4147.135 Safari/537.36
&gt; Accept: */*

&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
&lt; Content-Type: text/html
&lt; Server: Microsoft-IIS/7.5
&lt; X-Powered-By: ASP.NET
&lt; Date: Sun, <span style="color:#ae81ff">23</span> Aug <span style="color:#ae81ff">2020</span> 14:13:45 GMT
&lt; Content-Length: <span style="color:#ae81ff">1163</span>

....
</code></pre></div><p>按以往的安全人员惯用沉淀方式会自己使用Python语言写出POC（Proof of concept，概念验证）和EXP（Exploit，利用 国内简写风格）。关于概念验证，不同的安全人员在交换或使用POC的过程中会存在很多问题，如：库的依赖、代码风格不统一等等。关于漏洞的信息传递会失真，因为交换的不是“漏洞”本身，而是代码。另外，<a href="https://github.com/knownsec/Pocsuite">Pocsuite</a>解决了代码风格和使用的问题，不得不说很赞。但往往团队中会有不热爱写代码的人，亦或是不爱阅读文档的人，要完成漏洞的落地需要更加轻便的方法。</p>
<p><img src="https://rvn0xsy.oss-cn-shanghai.aliyuncs.com/ac14b3e6c4682e0c8b7a25820644c795.png" alt="2020-08-24-21-34-35"></p>
<p>通过使用<a href="https://gobies.org/#dl">Goby</a>，发现作者的思路非常赞，将常见POC的本质进行提取，把POC的落地变成了一个表单，这样直接解决了格式的问题，省去了编程的过程，但多人协作可能目前还未考虑进去，毕竟目前的定位是单兵工具。</p>
<p>总结下来也就是说，第三阶段需要解决：POC的去敏化、可配置化，让安全人员专注漏洞本身的检测与利用方式，而不是由他们去决定这个脚本怎么写、怎么高效的运行，这个是安全开发工程师应该干的事。</p>
<h3 id="第四阶段后渗透阶段信息协作与功能组织">第四阶段：后渗透阶段信息协作与功能组织</h3>
<p>从<a href="https://www.cobaltstrike.com/">Cobalt Strike</a>我们看到了C2（Command &amp; Control，命令控制）的特征模糊、Payload（载荷）的多样性、Beacon（信标）的接口化，但我认为它最值得我学习的是 — 协作模式。真正的从以往灰鸽子的CS（Client / Server）模式演变成了TC（TeamServer / Clients）的模式，它允许多个客户端连接和操作一个服务端。但它也有一些门槛（弊端），就是上手后想要完成一些复杂工作任务较为困难，光是解决免杀就要学习一些文章、或者编程（C语言、sleep脚本语言）等等，并且扩展的模块管理完全交给了每个使用者，hook（钩住）事件后n个客户端会触发n次。</p>
<p>从<a href="https://github.com/rapid7/metasploit-framework">Metasploit</a>我们看到了它的社区力量多么强大，模块繁多，近期又更新了6这个版本，将Meterpreter的通信进行了加密，是一个突破性的进步。这里需要一个具备<a href="https://www.cobaltstrike.com/">Cobalt Strike</a> 与 <a href="https://github.com/rapid7/metasploit-framework">Metasploit</a> 优点的后渗透工具或框架，生态需要尽量选择脚本语言，这样在时代的进步中迭代快。</p>
<h2 id="第二个思考团队建设中价值观与文化的重要性">第二个思考：团队建设中价值观与文化的重要性</h2>
<p>这个话题经常和我的领导探讨，我收获颇多，回想起以前的自己，思考的根本不会到现在这个深度。</p>
<p>所有企业管理者最大的难题就是“聚焦”，聚焦力量、聚焦思想，很多管理者或者员工没有换位思考的问题是：管理不是为了控制，而是为了让力量更好的聚焦。</p>
<p>价值观是基于人的一定的思维感官之上而作出的认知、理解、判断或抉择，也就是人认定事物、辩定是非的一种思维或取向，从而体现出人、事、物一定的价值或作用；在阶级社会中，不同阶级有不同的价值观念。价值观具有稳定性和持久性、历史性与选择性、主观性的特点。价值观对动机有导向的作用，同时反映人们的认知和需求状况。</p>
<p>—— 摘自 百度百科。</p>
<p>可以通过这句总结看出，价值观在不同阶级是有较大偏差的，所以每个企业的价值观基本都是非常的简单仅仅几个字，或者一句话，因为企业价值观需要尽可能的包容不同阶级的人群，比如企业的老板和其中的某个员工两个人，在哪些事物上会认知相同呢？举两个例子，比较简单的：某件事的是非对错，比较复杂的：在某种情况下，应当做出何种决定。</p>
<p>总结出来就是，企业良好的价值观让内部员工更容易的达成共识，能建立一个正向的引导，在价值观的影响下员工能够把能量释放到最合适的点上。</p>
<p>往往企业价值观的定义都会比较偏向“做人”这个点上，管理者需要具备某些品质才能拥有领导力、保障团队的良性发展，团队的成员才能有收获。因此可以看出，寻找一份工作不能只看薪水待遇，还要看公司价值观，直系领导的品质以及团队文化，这些要点一定会影响未来你在团队中的发展和工作状态。</p>
<p>团队文化，我的理解是通过价值观影响而产生的某些思维或行为习惯，也可以是某些人与人之间的约定。具体例如：项目完成的复盘总结、内部的做事流程、生日蛋糕祝福、定期的团建等等。优秀的团队文化能使人更快的建立信任，更具体的规范角色的行为，也可使人对团队的未来充满期待，能纵观整个自我成长的历史。</p>
<h2 id="第三个思考我们真的很幸运">第三个思考：我们真的很幸运</h2>
<p>去年有幸帮助公司的一级部门去给某学院的学生分享了一堂课，主要是关于自学安全的话题。</p>
<p>开始的时候分享了我的一些学习经历，我发现总结不出来如何培养自己的自学能力，因为第一个大前提：我做的是我热爱的事情，在年龄很小的时候就找到了自己喜欢的事情，为此愿意花大量的时间去探索技术，不断的学习。</p>
<p>从大部分普通应届生的角度来看找工作这件事，他们的选择往往很少，找到一个相对好的工作取决于自身在后天的积累是否能与社会某个职业的需要挂钩，但好像大多数学校的学生反馈的是专业知识都与职场应用有一定偏差，这就导致就业难，人生第一大门槛：“我该去往何方？”</p>
<p>**我对兴趣的理解是：“兴趣是人生不可或缺的调味剂，一定程度能够影响半生的幸福。”**一个好的兴趣是针对事物抱有无尽求知欲的，并且具备隐性的持续性，在探索的过程中、过程后，一定是情绪高涨，快乐的。我很庆幸，在年纪很小的时候拥有了兴趣，在不断探索求知的过程中，我不断收获成就感，洗涤内心的卑微，使得一个少年变得逐渐强大。</p>
<p>兴趣让我有了更多的选择，我的兴趣不只是安全领域，更深层次的总结可以说是对计算机网络相关的东西都感兴趣，它能使我化身成为程序员、网络工程师、产品经理、渗透测试人员等等。有许多次我都感慨，这是一个幸福的时代。</p>

</div>

        </div><div id="footer" class="mb-5">
    <hr>
    <div class="container text-center">
        
            <a href="https://twitter.com/Rvn0xsy" class="fab fa-twitter fa-1x" title="Twitter"></a>
        
            <a href="mailto:rvn0xsy@gmail.com" class="fas fa-envelope fa-1x" title="E-mail"></a>
        
    </div>
    
        <div class="container text-center">
            <a href="https://payloads.online" title="- PAYLOADS.ONLINE -"><small>- PAYLOADS.ONLINE -</small></a>
        </div>
    
</div>



<script src="https://cdn.jsdelivr.net/gh/jmnote/plantuml-encoder@1.2.4/dist/plantuml-encoder.min.js" integrity="sha256-Qsk2KRBCN5qVZX7B+8+2IvQl1Aqc723qV1tBCQaVoqo=" crossorigin="anonymous"></script>
<script>
(function(){
  let plantumlPrefix = "language-plantuml";
  Array.prototype.forEach.call(document.querySelectorAll("[class^=" + plantumlPrefix + "]"), function(code){
    let image = document.createElement("IMG");
    image.loading = 'lazy'; 
    image.src = 'http://www.plantuml.com/plantuml/svg/~1' + plantumlEncoder.encode(code.innerText);
    code.parentNode.insertBefore(image, code);
    code.style.display = 'none';
  });
})();
</script>

</body>
</html>
