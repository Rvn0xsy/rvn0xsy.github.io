<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Intranet Space - p0wnedShell - 倾旋的博客</title><meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/main.css><link rel=stylesheet type=text/css media=screen href=https://payloads.online/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://payloads.online/css/dark.css><script src=https://payloads.online/js/feather.min.js></script><script src=https://payloads.online/js/main.js></script></head><body><div class="container wrapper"><div class=header><div class=avatar><a href=https://payloads.online/><img src=/avatar.jpeg alt=倾旋的博客></a></div><h1 class=site-title><a href=https://payloads.online/>倾旋的博客</a></h1><div class=site-description><p>现阶段在进行有效性验证/攻击模拟相关的安全研究工作，我的博客会记录一些我的学习过程和部分安全技术研究成果。</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/rvn0xsy/ title=Github><i data-feather=github></i></a></li><li><a href=/index.xml title=RSS><i data-feather=rss></i></a></li><li><a href=/ title=Wechat><i data-feather=message-circle></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>首页</a></li><li><a href=/posts/>文章列表</a></li><li><a href=/tags>标签</a></li><li><a href=/projects>开源项目</a></li><li><a href=/about>关于我</a></li><li><a href=/links/>友情链接</a></li><li><a href=/message>留言</a></li><li><a href=/sponsor>赞助</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>18</span>
<span class=rest>Dec 2018</span></div></div><div class=matter><h1 class=title>Intranet Space - p0wnedShell</h1></div></div><h2 id=0x00-p0wnedshell>0x00 p0wnedShell</h2><p>p0wnedShell is an offensive PowerShell Runspace Post Exploitation host application written in C# that does not rely on powershell.exe but runs PowerShell commands and functions within a PowerShell run space environment (.NET). It has a lot of offensive PowerShell modules and binaries included making the process of Post Exploitation easier.</p><p>Github : <a href=https://github.com/Cn33liz/p0wnedShell>https://github.com/Cn33liz/p0wnedShell</a></p><h2 id=0x01-p0wnedshell-功能>0x01 p0wnedShell 功能</h2><ul><li>PowerSploit Invoke-Shellcode</li><li>PowerSploit Invoke-ReflectivePEInjection</li><li>PowerSploit Invoke-Mimikatz</li><li>PowerSploit Invoke-TokenManipulation</li><li>PowerSploit PowerUp</li><li>PowerSploit PowerView</li><li>HarmJ0y’s Invoke-Psexec</li><li>Besimorhino’s PowerCat</li><li>Nishang Invoke-PsUACme</li><li>Nishang Invoke-Encode</li><li>Nishang Get-PassHashes</li><li>Nishang Invoke-CredentialsPhish</li><li>Nishang Port-Scan</li><li>Nishang Copy-VSS</li><li>Kevin Robertson Invoke-Inveigh</li><li>Kevin Robertson Tater</li><li>FuzzySecurity Invoke-MS16-032</li></ul><h2 id=0x02-编译>0x02 编译</h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>bool</span> AutoMasq = <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>string</span> masqBinary = <span style=color:#e6db74>@&#34;C:\Windows\Notepad.exe&#34;</span>;
</span></span></code></pre></td></tr></table></div></div><p>如果AutoMasq为false，则不会进行进程注入，若为true，则会进行进程注入，伪装成C:\Windows\Notepad.exe.</p><p>需要Microsoft Visual Studio编译。</p><h2 id=0x03-lets-try>0x03 Let&rsquo;s Try!</h2><p><img src=https://images.payloads.online/3ea11d48-4f5f-11ec-a1dd-00d861bf4abb.jpg alt=try></p><p>随便选择一个：13</p><p><img src=https://images.payloads.online/3eedd76e-4f5f-11ec-8055-00d861bf4abb.jpg alt=try></p><p>会自动生成一个msf设置实例，根据提示设置一个监听器就好，最后按回车，就能获得会话。</p><p><img src=https://images.payloads.online/3f317e1a-4f5f-11ec-929b-00d861bf4abb.jpg alt=try></p><h2 id=0x04-总结>0x04 总结</h2><p>这个工具的优点就是加载powershell的行为不容易被AV查杀，但是编码只编码了一次，可能会被静态扫描到。</p><p>可以加一些反沙箱的功能，防止被传入云端。</p><p>还有一点就是不支持bypass uac，需要手动实现。</p><hr class=footer-separator><div class=tags></div><div class=back><a href=https://payloads.online/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div><div class=post><script src=https://giscus.app/client.js data-repo=Rvn0xsy/rvn0xsy.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk0MDEyMzI3MTY=" data-category=General data-category-id=DIC_kwDOF-pTTM4CRDk_ data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=dark_tritanopia data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div></div><div class="footer wrapper"><nav class=nav><div>2024 倾旋 All rights reserved</div></nav></div><script>feather.replace()</script></body></html>